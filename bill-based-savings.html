<!DOCTYPE html>
<html lang="en">
<head>
  <title>OneBill</title>
  <meta charset="utf-8" />
  <meta name="description" content="OneBill" />
  <meta name="keywords" content="OneBill" />
  <meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=0'>
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="OneBill" />
  <meta property="og:url" content="https://onebill.ie" />
  <meta property="og:site_name" content="OneBill" />
  <link rel="canonical" href="https://onebill.ie" />
  <link rel="icon" href="/assets/images/favicon.png" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <link rel="stylesheet" href="styles/style.bundle.css" type="text/css" />
  <link rel="stylesheet" href="styles/saveannual/style.css" />
  <link rel="stylesheet" href="styles/footer.css">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
    crossorigin="anonymous"></script>
  <!-- Analytics Scripts -->
  <script type="module" src="/js/utils/tracking.js"></script>
  <script type="module" src="/js/utils/initLayout.js"></script>
</head>
<body>
  <header></header>
  <!--begin::Wrapper-->
  <div class="app-wrapper flex-column flex-row-fluid ptb-sticky" id="kt_app_wrapper">
    <!--begin::Wrapper container-->
    <div class="app-container container-xxl">
      <!--begin::Main-->
      <div class="app-main flex-column flex-row-fluid" id="kt_app_main">
        <!--begin::Content wrapper-->
        <div class="d-flex flex-column flex-column-fluid">
          <!--begin::Content-->
          <div id="kt_app_content" class="app-content bg-body-tertiary">
            <!--begin::Stepper-->
            <div class="stepper stepper-links d-flex flex-column" id="kt_create_account_stepper">
              <!--begin::Nav-->
              <div class="stepper-nav mb-5 sticky">
                <!--begin::Step 1-->
                <div class="stepper-item current" data-kt-stepper-element="nav">
                  <h3 class="stepper-title"><span class="title1ac">Your Home</span><span class="title2ac"><i
                        class="fa-solid fa-house"></i></span></h3>
                </div>
                <!--end::Step 1-->
                <!--begin::Step 2-->
                <div class="stepper-item" data-kt-stepper-element="nav">
                  <h3 class="stepper-title"><span class="title1ac">Utilities</span><span class="title2ac"><i
                        class="fa-solid fa-gear"></i></span></h3>
                </div>
                <!--end::Step 2-->
                <!--begin::Step 3-->
                <div class="stepper-item input1dsnane" data-kt-stepper-element="nav">
                  <h3 class="stepper-title"><span class="title1ac">Electricity</span><span class="title2ac"><i
                        class="fa-solid fa-bolt"></i></span></h3>
                </div>
                <!--end::Step 3-->
                <!--begin::Step 4-->
                <div class="stepper-item input2dsnane" data-kt-stepper-element="nav">
                  <h3 class="stepper-title"><span class="title1ac">Gas</span><span class="title2ac"><i
                        class="fa-solid fa-fire-flame-simple"></i></span></h3>
                </div>
                <!--end::Step 4-->
                <!--begin::Step 5-->
                <div class="stepper-item input3dsnane" data-kt-stepper-element="nav">
                  <h3 class="stepper-title"><span class="title1ac">Internet</span><span class="title2ac"><i
                        class="fa-solid fa-wifi"></i></span></h3>
                </div>
                <!--end::Step 5-->
                <!--begin::Step 5-->
                <div class="stepper-item" data-kt-stepper-element="nav">
                  <h3 class="stepper-title"><span class="title1ac">Saving</span><span class="title2ac"><i
                        class="fa-solid fa-wallet"></i></span></h3>
                </div>
                <!--end::Step 5-->
              </div>
              <!--end::Nav-->
            </div>
            <form action="https://admin.onebill.ie/api/signUpApi" method="post" enctype="multipart/form-data"
              id="msform" name="msform" class="new-signin">
              <div class="d-flex mt-3 mb-3 border rounded-2 p-3 formChackACjsBtn" style="display: none !important">
                <label>Would you like OneBill to manage your Internet?</label>
                <div class="d-flex align-items-center justify-content-between">
                  <div class="form-check mb-0">
                    <label class="form-check-label" for="want_broadband-yes">
                      <input class="checkbox-input" id="want_broadband-yes" name="want_broadband" type="radio"
                        value="1" />
                      <span class="checkbox-tile">
                        <span class="checkbox-icon">
                          <i class="fa-regular fa-circle-check"></i>
                        </span>
                        <span class="checkbox-label">Yes</span>
                      </span>
                    </label>
                  </div>
                  <div class="form-check mb-0">
                    <label class="form-check-label" for="want_broadband-no">
                      <input checked="checked" class="checkbox-input" id="want_broadband-no" name="want_broadband"
                        type="radio" value="0" />
                      <span class="checkbox-tile">
                        <span class="checkbox-icon">
                          <i class="fa-regular fa-circle-xmark"></i>
                        </span>
                        <span class="checkbox-label">No</span>
                      </span>
                    </label>
                  </div>
                </div>
              </div>
              <div class="d-flex mt-3 mb-3 border rounded-2 p-3 formChackACjsBtn" style="display: none !important">
                <label>Would you like OneBill to manage your gas ?</label>
                <div class="d-flex align-items-center justify-content-between">
                  <div class="form-check mb-0">
                    <label class="form-check-label" for="want_gas-yes">
                      <input class="checkbox-input" id="want_gas-yes" name="want_gas" type="radio" value="1" />
                      <span class="checkbox-tile">
                        <span class="checkbox-icon">
                          <i class="fa-regular fa-circle-check"></i>
                        </span>
                        <span class="checkbox-label">Yes</span>
                      </span>
                    </label>
                  </div>
                  <div class="form-check mb-0">
                    <label class="form-check-label" for="want_gas-no">
                      <input checked="checked" class="checkbox-input" id="want_gas-no" name="want_gas" type="radio"
                        value="0" />
                      <span class="checkbox-tile">
                        <span class="checkbox-icon">
                          <i class="fa-regular fa-circle-xmark"></i>
                        </span>
                        <span class="checkbox-label">No</span>
                      </span>
                    </label>
                  </div>
                </div>
              </div>
              <div class="d-flex gap-lg-5 gap-3 mt-3 mb-3 border rounded-2 p-3 align-items-start formChackACjsBtn"
                style="display: none !important">
                <label>Would you like OneBill to manage your electricity?</label>
                <div class="d-flex align-items-center justify-content-between">
                  <div class="form-check mb-0">
                    <label class="form-check-label" for="want_electricity-yes">
                      <input class="checkbox-input" id="want_electricity-yes" name="want_electricity" type="radio"
                        value="1" />
                      <span class="checkbox-tile">
                        <span class="checkbox-icon">
                          <i class="fa-regular fa-circle-check"></i>
                        </span>
                        <span class="checkbox-label">Yes</span>
                      </span>
                    </label>
                  </div>
                  <div class="form-check mb-0">
                    <label class="form-check-label" for="want_electricity-no">
                      <input checked="checked" class="checkbox-input" id="want_electricity-no" name="want_electricity"
                        type="radio" value="0" />
                      <span class="checkbox-tile">
                        <span class="checkbox-icon">
                          <i class="fa-regular fa-circle-xmark"></i>
                        </span>
                        <span class="checkbox-label">No</span>
                      </span>
                    </label>
                  </div>
                </div>
              </div>
              <div id="onebilStepContent">
                <fieldset>
                  <div class="form-card ">
                    <div class="row justify-content-center"></div>
                    <div class="justify-content-center oaymentSnpage">
                      <div class="itemSnpage2">
                        <h5>You Could Save Up To</h5>
                        <h4 id="total-save1">€0.00 Euro</span></h4>
                        <input id="eltot" name="eltot" style="display:none" value="0">
                        <h5 id="total-save">Per Year</span></h5>
                        <!--<button type="button" id="signin" class="btn btn-success">Sign Up</button>-->
                      </div>
                      <div class="new-signin-head">
                        <strong>You are nearly there!</strong>
                        <span>Enter a few more details to finish your sign up</span>
                      </div>
                      <div id="stepper">
                        <div class="step oaymentSnpage" id="step1">
                          <div class="itemSnpage" style="flex-direction: row !important;">
                            <span class="left-section">
                              <div class="imgPav">
                                <img src="/assets/images/favicon.png" alt="">
                              </div>
                              <h3>OneBill Fee</h3>
                            </span>
                            <span class="right-section">
                              <span class="price" id="pricingText" data-monthly="10" data-annually="100">
                                <b>€100</b> Per Year
                              </span>
                          </div>
                          <div class="itemSnpage acel" style="display: none; flex-direction: row !important;">
                            <span>
                              <i class="fa-solid fa-bolt"></i>
                              <h3>Electricity:</h3>
                            </span>
                            <span class="price"><b id="electricity-save"><span id="elsavings"></span></b> Per
                              Year</span>
                          </div>
                          <div class="supplier-dropdown electricity-supplier" style="display: none;">
                            <h4>Current Supplier:</h4>
                            <p id="elsupplier"></p>
                          </div>
                          <div class="itemSnpage acgas" style="display: none; flex-direction: row !important;">
                            <span>
                              <i class="fa-solid fa-fire"></i>
                              <h3>Gas Saving:</h3>
                            </span>
                            <span class="price resultssize"><b id="gas-save"><span id="gassavings"></span></b> Per
                              Year</span>
                          </div>
                          <div class="supplier-dropdown gas-supplier" style="display: none;">
                            <h4>Current Supplier:</h4>
                            <p id="gassupplier"></p>
                          </div>
                          <div class="itemSnpage acint" style="display: none; flex-direction: row !important;">
                            <span>
                              <i class="fa-solid fa-wifi"></i>
                              <h3>Broadband Saving:</h3>
                            </span>
                            <span class="price"><b id="internet-save"><span id="intsavings"></span></b> Per Year</span>
                          </div>
                          <div class="supplier-dropdown broadband-supplier" style="display: none;">
                            <h4>Current Supplier:</h4>
                            <p id="intsupplier"></p>
                          </div>
                        </div>
                        <div class="step" id="step2" style="display:none;">
                          <div class="signin-form-wrapper">
                            <div class="form-floating2">
                              <label class="text-signin-label" for="user-name">Salutation</label>
                              <select class="form-control select2" id="gender" name="gender">
                                <option value="">Please Select</option>
                                <option value="Mrs.">Mrs.</option>
                                <option value="Mr.">Mr.</option>
                                <option value="Miss">Miss</option>
                                <option value="Ms.">Ms.</option>
                                <option value="Dr.">Dr.</option>
                                <option value="Prof.">Prof.</option>
                                <option value="Fr.">Fr.</option>
                              </select>
                            </div>
                            <div class="form-floating2 mt-2">
                              <label class="text-signin-label" for="user-name">Name</label>
                              <input id="token" name="token" type="text" style="display:none;" />
                              <input id="token2" name="token2" type="text" style="display:none;" />
                              <input aria-describedby="emailHelp" class="form-control" id="name" name="name"
                                placeholder="Enter Name" required="" type="text"
                                oninput="this.value = this.value.replace(/[^a-zA-Z\s]/g, '');" />
                            </div>
                            <div class="form-floating2 mt-2">
                              <label class="text-signin-label" for="user-name">Surname</label>
                              <input aria-describedby="emailHelp" class="form-control" id="surname" name="surname"
                                placeholder="Enter surname" required="" type="text"
                                oninput="this.value = this.value.replace(/[^a-zA-Z\s]/g, '');" />
                            </div>
                            <div class="form-floating2 mt-2">
                              <label class="text-signin-label" for="dateofbirth">Date of
                                Birth</label>
                              <input aria-describedby="emailHelp" class="form-control" id="dateofbirth"
                                name="dateofbirth" placeholder="DD/MM/YYYY" required="" type="text"
                                oninput="formatAndValidateDateOfBirth(this)" />
                              <span id="dateofbirth-error" class="text-danger uyari" style="display:none;">Please enter
                                a valid date in
                                DD/MM/YYYY format.</span>
                            </div>
                            <div class="form-floating2 mt-2">
                              <label class="text-signin-label" for="user-name">Phone</label>
                              <input class="form-control" id="localphone" name="localphone" placeholder="086475321"
                                required="" type="text" />
                              <input type="hidden" class="form-control" id="phone" name="phone" required=""
                                type="text" />
                              <input id="sendsmsbutton" class="action-button btn btn-success py-2 w-100" type="button"
                                value="Send SMS Verification Code" onclick="sendSMS()" />
                            </div>
                            <div id="verificationSection" style="display:none;">
                              <div class="form-floating2 mt-2">
                                <label class="text-signin-label" for="user-verificationCode">Enter Verification
                                  Code</label>
                                <input aria-describedby="emailHelp" class="form-control" id="verificationCode"
                                  name="verificationCode" placeholder="Enter SMS Code" type="number" required="" />
                                <input id="checksmsbutton" class="action-button btn btn-success px-5 py-2 w-100"
                                  type="button" value="Verify" onclick="checkSMS()" />
                              </div>
                            </div>
                            <div id="loaSection" style="display:none;">
                              <div class="form-floating2 mt-2">
                                <label class="text-signin-label" for="user-email">Email
                                  address</label>
                                <input aria-describedby="emailHelp" class="form-control" id="email" name="email"
                                  placeholder="test@onebill.ie" required type="email" />
                                <span id="emailError" class="text-danger" style="display:none;">Please enter a valid
                                  email
                                  address.</span>
                              </div>
                              <div class="form-floating2 mt-2">
                                <label class="text-signin-label" for="user-eircode">Search Eircode or Address</label>
                                <input aria-label="eircode" class="form-control" id="eircode" name="eircode"
                                  placeholder="Eircode" required type="text" />
                                <span id="eircodeError" class="text-danger" style="display:none;">Please enter a valid
                                  Eircode
                                  (e.g., A65F4E2).</span>
                                <!-- Static dropdown menu -->
                                <div id="dropdown-menu"
                                  style="display:none; position:absolute; background:white; border:1px solid #ccc; width:100%; z-index:1000;">
                                  <!-- Options will be populated dynamically -->
                                </div>
                              </div>
                              <div class="form-floating mt-2" id="address-field" style="display:none;">
                                <input aria-label="Address" class="form-control" id="address" name="address"
                                  placeholder="Address" required type="text" />
                                <label class="text-secondary" for="user-address">Address</label>
                                <span id="addressError" class="text-danger" style="display:none;">Please enter a valid
                                  address.</span>
                              </div>
                              <div class="form-floating2 mt-2">
                                <label class="text-signin-label" for="user-name">Password</label>
                                <div class="password-wrapper noconfirm">
                                  <input aria-describedby="emailHelp" class="form-control" id="password" name="password"
                                    placeholder="Enter Password" required="" type="password" />
                                  <i class="fa-solid fa-check"></i>
                                </div>
                                <div class="password-validation-checker"></div>
                                <ul id="passwordmatchresult">
                                </ul>
                              </div>
                              <div class="form-floating2 mt-2">
                                <label class="text-signin-label" for="user-name">Confirm
                                  Password</label>
                                <div class="password-wrapper confirm">
                                  <input aria-describedby="emailHelp" class="form-control" id="confirmpassword"
                                    name="confirmpassword" placeholder="Enter Password" required="" type="password" />
                                  <i class="fa-solid fa-check"></i>
                                </div>
                              </div>
                              <span id="passwordMatchMessage" class="text-danger"></span>
                              <input type="hidden" id="payment_period" name="payment_period" value="Yearly">
                              <!-- Optional: Remove the dropdown entirely if you never need it -->
                              <!-- If you want to keep it for reference but not show it, use style="display: none;" -->
                              <div class="form-floating2 mt-2" style="display: none;">
                                <label class="text-signin-label" for="payment_period">How Would You Like to Pay Your
                                  OneBill Fee?</label>
                                <select class="form-control select2" id="payment_dropdown" name="payment_period">
                                  <option value="Yearly" selected>Annually</option>
                                  <option value="Monthly">Monthly</option>
                                </select>
                              </div>
                              <!-- Blue box that shows payment information, shown conditionally -->
                              <div class="alert alert-primary mt-2" id="influencer_info" style="display: none;">
                                The content of this div will be dynamically updated
                              </div>
                              <!-- Purple box that shows more payment information, also shown conditionally -->
                              <div id="monthly-payment-info" class="mt-2" style="display: none;">
                                <div class="form-floating2 mt-2">
                                  <label style="margin-top: 2px; margin-bottom: 7px;">
                                    <small id="membership_info" style="font-size: 15px; font-weight: 500;"></small>
                                  </label>
                                  <div class="alert alert-info mt-2" id="payment_notice">
                                    This is where the payment notice will be
                                    dynamically updated
                                  </div>
                                </div>
                              </div>
                              <br>
                              <div class="form-floating mt-2 ps-3">
                                <div class="form-check">
                                  <input class="form-check-input ps-3" type="checkbox" value="1" id="termscheck"
                                    name="terms_check">
                                  <label class="form-check-label flexcol" for="termscheck">
                                    <span>I have read and accept OneBill's</span> <a target="_blank"
                                      href="/assets/docs/Terms and Conditions of OneBill Utilities Limited (July 2024).pdf">
                                      Terms and Conditions.</a>
                                  </label>
                                </div>
                              </div><br>
                              <div class="form-floating mt-2 ps-3">
                                <div class="form-check">
                                  <input class="form-check-input ps-3" type="checkbox" value="1" id="loacheck"
                                    name="loa_check">
                                  <label class="form-check-label flexcol" for="loacheck">
                                    <span>I have read and accept OneBill's</span> <a target="_blank"
                                      href="/assets/docs/loa1.pdf">Letter of
                                      Authority.</a>
                                  </label>
                                </div>
                              </div><br>
                              <div class="form-floating mt-2 ps-3 ibaninputchecker">
                                <div class="form-check">
                                  <input class="form-check-input ps-3" type="checkbox" value="1" id="mandatecheck"
                                    name="mandate_check">
                                  <label class="form-check-label flexcol" for="mandatecheck">
                                    <span>I have read and accept OneBill's</span> <a target="_blank"
                                      href="/assets/docs/onebill-mandate.pdf">
                                      Direct Debit Mandate.</a>
                                  </label>
                                </div>
                              </div><br>
                              <div class="form-floating2 mt-2 isibaninputchecked">
                                <label class="text-signin-label">Please Enter Your
                                  IBAN</label>
                                <input class="form-control" id="ibanInput" name="iban" placeholder="IBAN" required=""
                                  type="text" />
                                <span class="text-danger iban-error" id="ibanError" style="display: none;">Invalid IBAN.
                                  Please check
                                  the format and length.</span>
                              </div>
                              <div class="ibandetail">I understand that OneBill will be
                                setting up Direct Debits with my new suppliers using the
                                provided IBAN details.</div>
                              <main style="display:none;">
                                <div class="container-fluid h-100 d-flex flex-column">
                                  <div class="row overflow-hidden">
                                    <div class="col-12 h-100">
                                      <div class="card h-100">
                                        <div class="card-header">Letter of
                                          Authority
                                        </div>
                                        <div class="card-body overflow-auto">
                                          <p>Date; <span id="date" name="date"></span>
                                          </p>
                                          <p></p>Customer(s): <span id="loaname1" name="loaname1"></span>
                                          <p>Customer Registered Address:
                                            <span id="loaaddress1" name="loaaddress1"></span>
                                          </p>
                                          <p>Customer:
                                            <span id="loaname2"  name="loaname2"></span>
                                            <img src="" alt="" id="signatureImg2" style="display: none;">
                                          </p>
                                          <p>Customer Registered Address:
                                            <span id="loaaddress2" name="loaaddress2"></span>
                                          </p>
                                          <p>Name <span id="loaname3" name="loaname3"></span></p>
                                          <p> Date <span id="date2" name="date2"></span></p>
                                          <p>Signature
                                            <img src="" alt="" id="signatureImg" style="display: none;">
                                          </p>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </main><br>
                              <div class="d-flex flex-column">
                                <div class="row overflow-hidden">
                                  <style>
                                    form input[type=text],
                                    form textarea {
                                      padding: 5px;
                                    }
                                  </style>
                                  <div>
                                    <div class="singTabsnw">
                                      <div class="singTabsnwlinks imzFrmBtn2 active"
                                        onclick="opensingTabsnw(event, 'singTabsnwMouse')">
                                        Draw</div>
                                      <!--<div class="singTabsnwlinks" onclick="opensingTabsnw(event, 'singTabsnwText')">Type</div>-->
                                    </div>
                                    <div id="singTabsnwMouse" class="signaturesingTabsnwcontent"
                                      style="display: block;">
                                      <p>
                                        <span id="signature"></span>
                                        <span class="signature-information">Signature:
                                          <b class="text-danger">Use your
                                            mouse to create a digital
                                            signature</b></span>
                                        <button id="clear" class="btn btn-sm">Clear
                                          Signature</button>
                                      </p>
                                      <textarea name="signed1" id="signatureField" style="display: none"
                                        required="required"></textarea>
                                      <textarea name="signed2" id="signatureField2" style="display: none"></textarea>
                                      <textarea name="signed3" id="signatureField3" style="display: none"></textarea>
                                    </div>
                                    <div id="singTabsnwText" class="signaturesingTabsnwcontent">
                                      <p>To sign by typing text:</p>
                                      <input type="text" id="signatureTextInput" placeholder="Enter Your Signature"
                                        oninput="updateFont()">
                                      <br>
                                      <select id="fontSelector" onchange="updateFont()">
                                        <option value="Sacramento" style="font-family: 'Sacramento';">
                                          Signature 1</option>
                                        <option value="Allura" style="font-family: 'Allura';">
                                          Signature 2</option>
                                        <option value="Calligraffitti" style="font-family: 'Calligraffitti';">
                                          Signature 3</option>
                                        <option value="Indie Flower" style="font-family: 'Indie Flower';">
                                          Signature 4</option>
                                        <option value="Pacifico" style="font-family: 'Pacifico';">
                                          Signature 5</option>
                                        <option value="Dancing Script" style="font-family: 'Dancing Script';">
                                          Signature 6</option>
                                      </select>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <input type="hidden" id="house_type2" name="house_type"></input>
                              <input type="hidden" id="peopleNumber2" name="peopleNumber"></input>
                              <input type="hidden" id="bedroomNumber2" name="bedroomNumber"></input>
                              <input type="hidden" id="solarNumber2" name="solarNumber"></input>
                              <input type="hidden" id="batteriesNumber2" name="batteriesNumber"></input>
                              <input type="hidden" id="evNumber2" name="evNumber"></input>
                              <input type="hidden" id="have_smart_meter2" name="have_smart_meter"></input>
                              <input type="hidden" id="permission_esb_network2" name="permission_esb_network"></input>
                              <input type="hidden" id="best_describe2" name="best_describe"></input>
                              <input type="hidden" id="seai_ber2" name="seai_ber"></input>
                              <input type="hidden" id="responsible_for_paying2" name="responsible_for_paying"></input>
                              <input type="hidden" id="electricity_provider_id2" name="electricity_provider_id"></input>
                              <input type="hidden" id="electricity_payment_type2"
                                name="electricity_payment_type"></input>
                              <input type="hidden" id="dg_type_id2" name="dg_type_id"></input>
                              <input type="hidden" id="mcc_id2" name="mcc_id"></input>
                              <input type="hidden" id="electricity_tariff_name2" name="electricity_tariff_name"></input>
                              <input type="hidden" id="dontKnowElectricityTariffName2"
                                name="dontKnowElectricityTariffName"></input>
                              <input type="hidden" id="electricity_euro2" name="electricity_euro"></input>
                              <input type="hidden" id="electricity_kwh2" name="electricity_kwh"></input>
                              <input type="hidden" id="internet_euro2" name="internet_euro"></input>
                              <input type="hidden" id="tot2" name="tot"></input>
                              <input type="hidden" id="gas_provider_id2" name="gas_provider_id"></input>
                              <input type="hidden" id="gas_payment_type2" name="gas_payment_type"></input>
                              <input type="hidden" id="heating_type2" name="heating_type"></input>
                              <input type="hidden" id="gas_tariff_name2" name="gas_tariff_name"></input>
                              <input type="hidden" id="gas_kwh2" name="gas_kwh"></input>
                              <input type="hidden" id="gas_euro2" name="gas_euro"></input>
                              <input type="hidden" id="internet_provider_id2" name="internet_provider_id"></input>
                              <input type="hidden" id="bundle_part2" name="bundle_part"></input>
                              <input type="hidden" id="bundle_include2" name="bundle_include"></input>
                              <input class="submit action-button btn btn-success px-5 py-2 w-100" id="signupButton"
                                type="submit" value="Signup" disabled />
                            </div>
                          </div>
                        </div>
                        <div class="d-flex flex-stack pt-15">
                          <div class="mr-2">
                            <button type="button" class="btn btn-outline-success  me-3" id="prevBtn"
                              style="display:none;"><i class="fa fa-chevron-left"></i> Back</button>
                          </div>
                          <div>
                            <button type="button" class="btn btn-success" id="nextBtn">Continue <i
                                class="fa fa-chevron-right"></i></button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </fieldset>
              </div>
            </form>
            <!--end::Stepper-->
          </div>
          <!--end::Content-->
        </div>
        <!--end::Content wrapper-->
      </div>
      <!--end:::Main-->
    </div>
    <!--end::Wrapper container-->
  </div>
  <!--end::Wrapper-->
  </div>
  <!--end::Page-->
  </div>
  <!--end::App-->
  <footer></footer>

  <script>var hostUrl = "assets/";</script>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <!--begin::Global Javascript Bundle(mandatory for all pages)-->
  <script src="/js/plugins/plugins.bundle.js"></script>
  <script src="/js/scripts.bundle.js"></script>
  <!--end::Global Javascript Bundle-->
  <!--begin::Custom Javascript(used for this page only)-->
  <script src="/js/keentheme-custom/modals/create-account.js"></script>
  <script src="/js/keentheme-custom/modals/js.js"></script>
  <script src="/js/keentheme-custom/widgets.bundle.js"></script>
  <script src="/js/keentheme-custom/widgets.js"></script>
  <script src="/js/keentheme-custom/chat.js"></script>
  <script src="/js/keentheme-custom/modals/upgrade-plan.js"></script>
  <script src="/js/keentheme-custom/modals/create-campaign.js"></script>
  <script src="/js/keentheme-custom/modals/users-search.js"></script>
  <!--end::Custom Javascript-->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      console.log("User Token:", window.localStorage.getItem("tok"));

      let tok = localStorage.getItem("tok");

      if (tok === "ClaireClarkson") {
        document.querySelector(".welcome").style.display = "block";
      }

      // Retrieve savings values
      let electricitySaving = parseFloat(localStorage.getItem("electot")) || 0;
      let gasSaving = parseFloat(localStorage.getItem("gastot")) || 0;
      let broadbandSaving = parseFloat(localStorage.getItem("inttot")) || 0;

      // Calculate total savings
      let totalSavings = electricitySaving + gasSaving + broadbandSaving;

      // Update total savings display
      document.getElementById("total-save1").innerHTML = `€${totalSavings.toFixed(2)} Euro`;
      document.getElementById("eltot").value = totalSavings.toFixed(2);

      // Retrieve supplier names
      let electricitySupplier = localStorage.getItem("elecprovider") || "N/A";
      let gasSupplier = localStorage.getItem("gasprovider") || "N/A";
      let broadbandSupplier = localStorage.getItem("intprovider") || "N/A";

      // Update individual savings display
      document.getElementById("elsavings").innerHTML = `<span style="color: #198754; font-weight: bold;">€${electricitySaving.toFixed(2)}</span>`;
      document.getElementById("gassavings").innerHTML = `<span style="color: #198754; font-weight: bold;">€${gasSaving.toFixed(2)}</span>`;
      document.getElementById("intsavings").innerHTML = `<span style="color: #198754; font-weight: bold;">€${broadbandSaving.toFixed(2)}</span>`;

      // Show savings sections and corresponding supplier information
      if (electricitySaving > 0) {
        document.querySelector(".acel").style.display = "flex";
        document.querySelector(".electricity-supplier").style.display = "block";
        document.getElementById("elsupplier").innerText = electricitySupplier;
      }

      if (gasSaving > 0) {
        document.querySelector(".acgas").style.display = "flex";
        document.querySelector(".gas-supplier").style.display = "block";
        document.getElementById("gassupplier").innerText = gasSupplier;
      }

      if (broadbandSaving > 0) {
        document.querySelector(".acint").style.display = "flex";
        document.querySelector(".broadband-supplier").style.display = "block";
        document.getElementById("intsupplier").innerText = broadbandSupplier;
      }

      // Stepper Navigation Logic
      let currentStep = 1;
      document.getElementById("nextBtn")?.addEventListener("click", function () {
        if (currentStep === 1) {
          document.getElementById("step1").style.display = "none";
          document.getElementById("step2").style.display = "block";
          document.getElementById("prevBtn").style.display = "block";
          document.getElementById("nextBtn").style.display = "none";
          currentStep++;
        }
      });

      document.getElementById("prevBtn")?.addEventListener("click", function () {
        if (currentStep === 2) {
          document.getElementById("step2").style.display = "none";
          document.getElementById("step1").style.display = "block";
          document.getElementById("prevBtn").style.display = "none";
          document.getElementById("nextBtn").style.display = "block";
          currentStep--;
        }
      });

      // Handling House Type Selection for Gas Estimates
      document.querySelectorAll('input[name="house_type"]').forEach((input) => {
        input.addEventListener("change", function () {
          let selectedHouseType = document.querySelector('input[name="house_type"]:checked').value;
          let gasKwhValue = "13000"; // Default
          let gasEuroValue = "1584";

          switch (selectedHouseType) {
            case "Apartment":
              gasKwhValue = "7000";
              gasEuroValue = "913";
              break;
            case "Terraced":
            case "Semi-Detached":
              gasKwhValue = "10500";
              gasEuroValue = "1304";
              break;
            case "Bungalow":
            case "Detached":
              gasKwhValue = "13000";
              gasEuroValue = "1584";
              break;
          }

          document.getElementById("gas_kwh_disable").value = gasKwhValue;
          document.getElementById("gas_euro_disable").value = gasEuroValue;
        });
      });
    });
  </script>
  <script>
    $(document).ready(function () {
      $('#gas_kwh_disable').val(13000);
      $('#gas_euro_disable').val(1584);
      var mcc_id = $('input[name="mcc_id"]:checked').val();
      if (mcc_id == '132') {
        $('#electricity_euro_disable').val(1755);
      }

      if (mcc_id == '131') {
        $('#electricity_euro_disable').val(1599);
      }

      if (mcc_id == '134') {
        $('#electricity_euro_disable').val(1574);
      }


      function fetchElectricityTariffs() {
        $.ajax({
          url: "https://admin.onebill.ie/api/electricityProviderName",
          type: "POST",
          data: {
            provider_id: $('#electricity_provider_id').val(),
            mcc_id: $('input[name="mcc_id"]:checked').val(),
            dg_type_id: $('input[name="dg_type_id"]:checked').val()
          },
          dataType: 'json',
          success: function (response) {
            var options = '<option value="" selected="selected">Please Select</option>';
            $.each(response, function (index, item) {
              options += '<option value="' + item.id + '">' + item.title + '</option>';
            });
            $('#electricity_tariff_name').html(options);
          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      // Attach change event listeners
      $('#electricity_provider_id').on('change', fetchElectricityTariffs);
      $('input[name="mcc_id"]').on('change', fetchElectricityTariffs);
      $('input[name="dg_type_id"]').on('change', fetchElectricityTariffs);
    });
  </script>


  <script>
    $(document).ready(function () {
      $('#gas_provider_id').change(function () {
        $.ajax({
          url: "https://admin.onebill.ie/api/gasProviderName",
          type: "POST",
          data: 'provider_id=' + $('#gas_provider_id').val(),
          dataType: 'json',
          success: function (response) {
            var options = '<option value="" selected="selected">Please Select</option>';
            $.each(response, function (index, item) {
              options += '<option value="' + item.id + '">' + item.title + '</option>';
            });
            $('#gas_tariff_name').html(options);

          },
          error: function (xhr, status, error) {
          }
        });
      });
    });
  </script>

  <script>
    $(document).ready(function () {

      var mcc_id = $('input[name="mcc_id"]:checked').val();
      if ($('#electricity_tariff_name').val() == "" || $('#electricity_tariff_name').val() == null) {
        if (mcc_id == '132') {
          $('#electricity_euro_disable').val(1755);
        }

        if (mcc_id == '131') {
          $('#electricity_euro_disable').val(1599);
        }

        if (mcc_id == '134') {
          $('#electricity_euro_disable').val(1574);
        }


      }

      $('input[name="mcc_id"]').on('change', function () {
        var mcc_id = $(this).val();
        if ($('#electricity_tariff_name').val() == "" || $('#electricity_tariff_name').val() == null) {

          if ($('#electricity_provider_id').val() == "" || $('#electricity_tariff_name').val() == null) {
            if (mcc_id == '132') {
              $('#electricity_euro_disable').val(1755);
            } else if (mcc_id == '131') {
              $('#electricity_euro_disable').val(1599);
            } else if (mcc_id == '134') {
              $('#electricity_euro_disable').val(1574);
            }
          } else {
            fetchElectricityDefaultTariffs();
          }

        } else {
          if ($('#dontKnowElectricityTariffName').is(':checked')) {
            fetchElectricityDefaultTariffs();
          } else {
            fetchElectricityCurrentTariffs();
          }

        }
      });

      $('#electricity_provider_id').change(function () {
        fetchElectricityDefaultTariffs();
      });

      $('#elec_date_dont_know').change(function () {
        if ($(this).is(':checked')) {
          $('select[name="electricity_month"]').prop('disabled', true).val('Month');
          $('select[name="electricity_year"]').prop('disabled', true).val('Year');
          fetchElectricityDefaultTariffs();
        } else {
          $('select[name="electricity_month"]').prop('disabled', false);
          $('select[name="electricity_year"]').prop('disabled', false);
        }
      });

      // Sayfa yüklendiğinde checkbox seçili ise selectbox'ları devre dışı bırak
      if ($('#elec_date_dont_know').is(':checked')) {
        $('select[name="electricity_month"]').prop('disabled', true).val('Month');
        $('select[name="electricity_year"]').prop('disabled', true).val('Year');
      }


      function fetchElectricityCurrentTariffs() {
        var mcc_id = $('input[name="mcc_id"]:checked').val();
        if ($('#electricity_tariff_name').val() == "" || $('#electricity_tariff_name').val() == null) {
          if (mcc_id == '132') {
            var tariff = 2982;
          }

          if (mcc_id == '131') {
            var tariff = 2978;
          }

          if (mcc_id == '134') {
            var tariff = 2875;
          }
        } else {
          var tariff = $('#electricity_tariff_name').val();
        }

        $.ajax({
          url: "https://admin.onebill.ie/api/electricityCurrentTariff",
          type: "POST",
          data: {
            tariff_id: tariff
          },
          dataType: 'json',
          success: function (response) {
            //response.electricity_standing_charge
            if (mcc_id == '132') {
              var est = $('#electricity_kwh_disable').val();
              var deg = (est * response.electricity_24_hour_rate) + (response.electricity_standing_charge) + (((est * response.electricity_24_hour_rate) + (response.electricity_standing_charge)) * 0.09);
              window.myGlobalVariable = deg;
              console.log(window.myGlobalVariable);
              $('#electricity_euro_disable').val(deg);
            }

            if (mcc_id == '131') {
              var est = $('#electricity_kwh_disable').val();
              var deg = (((est * 62) / 100) * response.electricity_day_rate) + (((est * 38) / 100) * response.electricity_night_rate) + (response.electricity_standing_charge) + (((((est * 62) / 100) * response.electricity_day_rate) + (((est * 38) / 100) * response.electricity_night_rate)) * 0.09);
              window.myGlobalVariable = deg;
              console.log(window.myGlobalVariable);
              $('#electricity_euro_disable').val(deg);
            }

            if (mcc_id == '134') {
              var est = $('#electricity_kwh_disable').val();
              var deg = (((est * 9) / 100) * response.electricity_peak_rate) + (((est * 52) / 100) * response.electricity_day_rate) + (((est * 39) / 100) * response.electricity_night_rate) + (response.electricity_standing_charge) + (((((est * 9) / 100) * response.electricity_peak_rate) + (((est * 52) / 100) * response.electricity_day_rate) + (((est * 39) / 100) * response.electricity_night_rate)) * 0.09);
              window.myGlobalVariable = deg;
              console.log(window.myGlobalVariable);
              $('#electricity_euro_disable').val(deg);
            }

          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function fetchElectricityDefaultTariffs() {
        var mcc_id = $('input[name="mcc_id"]:checked').val();
        $.ajax({
          url: "https://admin.onebill.ie/api/electricityDefaultTariff",
          type: "POST",
          data: {
            provider_id: $('#electricity_provider_id').val(),
            mcc_id: mcc_id
          },
          dataType: 'json',
          success: function (response) {
            //response.electricity_standing_charge
            console.log("burası" + response.electricity_title); // Response'u kontrol edin
            var selectElement = $('select[name="electricity_tariff_name"]');
            var matchingOption = selectElement.find('option').filter(function () {
              return $(this).text() === response.electricity_title;
            });

            if (matchingOption.length > 0) {
              selectElement.val(matchingOption.val());
            } else {
              console.error("Response title is not a valid option text.");
            }
            if (mcc_id == '132') {
              var est = $('#electricity_kwh_disable').val();
              var deg = (est * response.electricity_24_hour_rate) + (response.electricity_standing_charge) + (((est * response.electricity_24_hour_rate) + (response.electricity_standing_charge)) * 0.09);
              window.myGlobalVariable = deg;
              console.log(window.myGlobalVariable);
              $('#electricity_euro_disable').val(deg);
            }

            if (mcc_id == '131') {
              var est = $('#electricity_kwh_disable').val();
              var deg = (((est * 62) / 100) * response.electricity_day_rate) + (((est * 38) / 100) * response.electricity_night_rate) + (response.electricity_standing_charge) + (((((est * 62) / 100) * response.electricity_day_rate) + (((est * 38) / 100) * response.electricity_night_rate)) * 0.09);
              window.myGlobalVariable = deg;
              console.log(window.myGlobalVariable);
              $('#electricity_euro_disable').val(deg);
            }

            if (mcc_id == '134') {
              var est = $('#electricity_kwh_disable').val();
              var deg = (((est * 9) / 100) * response.electricity_peak_rate) + (((est * 52) / 100) * response.electricity_day_rate) + (((est * 39) / 100) * response.electricity_night_rate) + (response.electricity_standing_charge) + (((((est * 9) / 100) * response.electricity_peak_rate) + (((est * 52) / 100) * response.electricity_day_rate) + (((est * 39) / 100) * response.electricity_night_rate)) * 0.09);
              window.myGlobalVariable = deg;
              console.log(window.myGlobalVariable);
              $('#electricity_euro_disable').val(deg);
            }
          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function updateElectricityTariff() {
        if ($('#dontKnowElectricityTariffName').is(':checked')) {
          fetchElectricityDefaultTariffs();
        } else {
          fetchElectricityCurrentTariffs();
        }
      }

      $('#dontKnowElectricityTariffName').on('change', updateElectricityTariff);

      $('input[name="electricity_kwh_disable"]').on('change', updateElectricityTariff);

      $('#electricity_tariff_name').on('change', fetchElectricityCurrentTariffs);





      if ($('#kwhCheckbox').is(':checked')) {
        updateElectricityTariff();
      }

      $('#dontknowCheckbox').on('change', function () {
        if ($(this).is(':checked')) {
          $('#electricity_kwh_disable').val(4200);
          fetchElectricityCurrentTariffs();
        }
      });



    });
  </script>

  <script>
    $(document).ready(function () {

      function fetchElectricityCurrentEuro() {
        var mcc_id = $('input[name="mcc_id"]:checked').val();
        $.ajax({
          url: "https://admin.onebill.ie/api/electricityCurrentTariff",
          type: "POST",
          data: {
            tariff_id: $('#electricity_tariff_name').val()
          },
          dataType: 'json',
          success: function (response) {
            if (mcc_id == '132') {
              var rate = response.electricity_24_hour_rate;
              var standing_charge = response.electricity_standing_charge;
              var est = ($('#electricity_euro_disable').val() - standing_charge * 1.09) / (rate * 1.09);
              $('#electricity_kwh_disable').val(est);
            }

            if (mcc_id == '131') {

              var numerator = $('#electricity_euro_disable').val() - response.electricity_standing_charge;
              var denominator = ((62 * response.electricity_day_rate * 1.09 / 100) + (38 * response.electricity_night_rate * 1.09 / 100));
              var est = numerator / denominator;
              $('#electricity_kwh_disable').val(est);
            }

            if (mcc_id == '134') {
              var numerator = $('#electricity_euro_disable').val() - response.electricity_standing_charge;
              var denominator = (9 * response.electricity_peak_rate / 100) +
                (52 * response.electricity_day_rate / 100) +
                (39 * response.electricity_night_rate / 100);
              var est = numerator / (denominator * 1.09);
              $('#electricity_kwh_disable').val(est);
            }

          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function fetchElectricityDefaultEuro() {
        var mcc_id = $('input[name="mcc_id"]:checked').val();
        $.ajax({
          url: "https://admin.onebill.ie/api/electricityDefaultTariff",
          type: "POST",
          data: {
            provider_id: $('#electricity_provider_id').val()
          },
          dataType: 'json',
          success: function (response) {
            if (mcc_id == '132') {
              var rate = response.electricity_24_hour_rate;
              var standing_charge = response.electricity_standing_charge;
              var est = ($('#electricity_euro_disable').val() - standing_charge * 1.09) / (rate * 1.09);
              $('#electricity_kwh_disable').val(est);
            }

            if (mcc_id == '131') {
              var numerator = $('#electricity_euro_disable').val() - response.electricity_standing_charge;
              var denominator = ((62 * response.electricity_day_rate * 1.09 / 100) + (38 * response.electricity_night_rate * 1.09 / 100));
              var est = numerator / denominator;
              $('#electricity_kwh_disable').val(est);
            }

            if (mcc_id == '134') {
              var numerator = $('#electricity_euro_disable').val() - response.electricity_standing_charge;
              var denominator = (9 * response.electricity_peak_rate / 100) +
                (52 * response.electricity_day_rate / 100) +
                (39 * response.electricity_night_rate / 100);
              var est = numerator / (denominator * 1.09);
              $('#electricity_kwh_disable').val(est);
            }
          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function updateElectricityEuro() {
        if ($('#dontKnowElectricityTariffName').is(':checked')) {
          fetchElectricityDefaultEuro();
        } else {
          fetchElectricityCurrentEuro();
        }
      }

      $('#dontKnowElectricityTariffName').on('change', updateElectricityEuro);

      $('input[name="electricity_euro_disable"]').on('change', updateElectricityEuro);

      if ($('#euroCheckbox').is(':checked')) {
        updateElectricityEuro();
      }

      // jQuery ile input alanının değişiklik olayı (change) yakalanır
      $('#electricity_euro').on('input', function () {
        // electricity_euro alanının değeri alınır
        var euroValue = $(this).val();

        // alınan değer electricity_euro_disable alanına yazılır
        $('#electricity_euro_disable').val(euroValue);

      });

      // jQuery ile input alanının değişiklik olayı (change) yakalanır
      $('#electricity_kwh').on('input', function () {
        // electricity_euro alanının değeri alınır
        var kwhValue = $(this).val();

        // alınan değer electricity_euro_disable alanına yazılır
        $('#electricity_kwh_disable').val(kwhValue);

      });

    });
  </script>

  <script>
    $(document).ready(function () {
      var input = $('#peopleNumber');
      $('#peopleNumber_increment').click(function () {
        input.val(parseInt(input.val()) + 1);
      });
      $('#peopleNumber_decrement').click(function () {
        var value = parseInt(input.val());
        if (value > 0) {
          input.val(value - 1);
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      var input = $('#bedroomNumber');
      $('#bedroomNumber_increment').click(function () {
        input.val(parseInt(input.val()) + 1);
      });
      $('#bedroomNumber_decrement').click(function () {
        var value = parseInt(input.val());
        if (value > 0) {
          input.val(value - 1);
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      var input = $('#solarNumber');
      $('#solarNumber_increment').click(function () {
        input.val(parseInt(input.val()) + 1);
      });
      $('#solarNumber_decrement').click(function () {
        var value = parseInt(input.val());
        if (value > 0) {
          input.val(value - 1);
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      var input = $('#batteriesNumber');
      $('#batteriesNumber_increment').click(function () {
        input.val(parseInt(input.val()) + 1);
      });
      $('#batteriesNumber_decrement').click(function () {
        var value = parseInt(input.val());
        if (value > 0) {
          input.val(value - 1);
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      var input = $('#evNumber');
      $('#evNumber_increment').click(function () {
        input.val(parseInt(input.val()) + 1);
      });
      $('#evNumber_decrement').click(function () {
        var value = parseInt(input.val());
        if (value > 0) {
          input.val(value - 1);
        }
      });
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Select the dropdown and the hidden divs
      var bestDescribe = document.getElementById("best_describe");
      var hiddenDivs = document.querySelectorAll(".best_describe_hide");

      // Add event listener to the dropdown
      bestDescribe.addEventListener("change", function () {
        if (bestDescribe.value === "Home Owner") {
          hiddenDivs.forEach(function (div) {
            div.style.display = "block";
          });
        } else {
          hiddenDivs.forEach(function (div) {
            div.style.display = "none";
          });
        }
      });
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Select the dropdown and the hidden divs
      var haveSmartMeter = document.getElementById("have_smart_meter");
      var hiddenSmartDivs = document.querySelectorAll(".have_smart_meter_hide");

      // Add event listener to the dropdown
      haveSmartMeter.addEventListener("change", function () {
        if (haveSmartMeter.value === "1") {
          hiddenSmartDivs.forEach(function (div) {
            div.style.display = "block";
          });
        } else {
          hiddenSmartDivs.forEach(function (div) {
            div.style.display = "none";
          });
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      $("#euroCheckbox").change(function () {
        if ($(this).is(":checked")) {
          $("#euroCheckboxHide").show();
          $("#kwhCheckboxHide").hide();
        } else {
          $("#euroCheckboxHide").hide();
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      $("#kwhCheckbox").change(function () {
        if ($(this).is(":checked")) {
          $("#kwhCheckboxHide").show();
          $("#euroCheckboxHide").hide();
        } else {
          $("#kwhCheckboxHide").hide();
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      $("#dontknowCheckbox").change(function () {
        if ($(this).is(":checked")) {
          $("#kwhCheckboxHide").hide();
          $("#euroCheckboxHide").hide();
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      $("#gas_euroCheckbox").change(function () {
        if ($(this).is(":checked")) {
          $("#gas_euroCheckboxHide").show();
          $("#gas_kwhCheckboxHide").hide();
        } else {
          $("#gas_euroCheckboxHide").hide();
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      $("#gas_kwhCheckbox").change(function () {
        if ($(this).is(":checked")) {
          $("#gas_kwhCheckboxHide").show();
          $("#gas_euroCheckboxHide").hide();
        } else {
          $("#gas_kwhCheckboxHide").hide();
        }
      });
    });
  </script>

  <script>
    $(document).ready(function () {
      $("#gas_dontknowCheckbox").change(function () {
        if ($(this).is(":checked")) {
          $("#gas_kwhCheckboxHide").hide();
          $("#gas_euroCheckboxHide").hide();
        }
      });
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Get the radio button and the hidden div
      var corporateRadio = document.getElementById("kt_create_account_form_account_type_corporate");
      var eircodeDiv = document.getElementById("eircodeDiv");

      // Add event listener to the radio button
      corporateRadio.addEventListener("change", function () {
        if (corporateRadio.checked) {
          eircodeDiv.style.display = "block"; // Show the div
        }
      });

      // Optional: Hide the div if other options are selected (if you have other radio buttons)
      // Add listeners for other radio buttons if applicable
      var otherRadios = document.querySelectorAll('input[name="account_type"]:not(#kt_create_account_form_account_type_corporate)');
      otherRadios.forEach(function (radio) {
        radio.addEventListener("change", function () {
          if (radio.checked) {
            eircodeDiv.style.display = "none"; // Hide the div
          }
        });
      });
    });
  </script>

  <script>
    const $addressDropdown = $("#addressDropdown");
    const $addressInput = $("#addressInput");
    const $addressDiv = $("#addressDiv");

    $("#eir-code").on("keyup", function () {
      let eircode = $(this).val();
      $addressInput.hide();
      $addressDiv.hide();

      $.ajax({
        type: "POST",
        url: "https://admin.onebill.ie/api/getAddress",
        data: { eircode: eircode },

        success: function (data) {
          $addressDropdown.show();
          $addressDropdown.empty();

          if (data.addresses && data.addresses.length > 0) {
            $.each(data.addresses, function (index, addrObj) {
              if (addrObj.address !== "" && addrObj.address !== null) {
                $addressDropdown.append(
                  $("<li>").append(
                    $("<a>", {
                      class: "dropdown-item",
                      href: "#",
                      id: addrObj.eircode,
                      text: addrObj.address,
                    }).attr("data-eircode", addrObj.eircode)
                  )
                );
              }
            });

          }

        },
      });
    });

    $addressDropdown.on("click", "a", function () {
      const selectedAddress = $(this).text();
      $addressInput.val(selectedAddress);

      const selectedId = $(this).attr("id");
      $("#eir-code").val(selectedId);
      $("#adressandeircode").text(selectedAddress);

      localStorage.setItem('eircode', selectedId);
      localStorage.setItem('address', selectedAddress);

      $addressInput.show();
      $addressDiv.show();
      $addressDropdown.empty();
    });
  </script>

  <script>
    $(document).ready(function () {
      $('#submitButton').on('click', function (e) {
        e.preventDefault();


        $(this).find('.indicator-label').hide();
        $(this).find('.indicator-progress').show();

        // Form verilerini topla
        var formData = $('#kt_create_account_form').serialize();

        $.ajax({
          url: 'https://admin.onebill.ie/api/compare',
          type: 'POST',
          data: formData,
          dataType: 'json',
          success: function (data) {
            $('.addrow').empty();
            $.ajax({
              url: 'https://admin.onebill.ie/api/getTariff',
              type: 'POST',
              data: { electricity_tariff: data.electricity_tariff, gas_tariff: data.gas_tariff },
              dataType: 'json',
              success: function (data2) {


                var tot = 0;
                const params = new URLSearchParams(window.location.search);
                const input1Checked = params.get('input1');
                const input2Checked = params.get('input2');
                const input3Checked = params.get('input3');

                if (input1Checked === "true") {
                  var mcc_id = $('input[name="mcc_id"]:checked').val();
                  //response.electricity_standing_charge
                  if (mcc_id == '132') {
                    var est = $('#electricity_kwh_disable').val();
                    var deg = (est * data2.electricity_24_hour_rate) + (data2.electricity_standing_charge) + (((est * data2.electricity_24_hour_rate) + (data2.electricity_standing_charge)) * 0.09);
                    window.myGlobalVariable2 = deg;
                    console.log(window.myGlobalVariable2);
                  }

                  if (mcc_id == '131') {
                    var est = $('#electricity_kwh_disable').val();
                    var deg = (((est * 62) / 100) * data2.electricity_day_rate) + (((est * 38) / 100) * data2.electricity_night_rate) + (data2.electricity_standing_charge) + (((((est * 62) / 100) * data2.electricity_day_rate) + (((est * 38) / 100) * data2.electricity_night_rate) + (data2.electricity_standing_charge)) * 0.09);
                    window.myGlobalVariable2 = deg;
                    console.log(window.myGlobalVariable2);
                  }

                  if (mcc_id == '134') {
                    var est = $('#electricity_kwh_disable').val();
                    var deg = (((est * 9) / 100) * data2.electricity_peak_rate) + (((est * 52) / 100) * data2.electricity_day_rate) + (((est * 39) / 100) * data2.electricity_night_rate) + (data2.electricity_standing_charge) + (((((est * 9) / 100) * data2.electricity_peak_rate) + (((est * 52) / 100) * data2.electricity_day_rate) + (((est * 39) / 100) * data2.electricity_night_rate) + (data2.electricity_standing_charge)) * 0.09);
                    window.myGlobalVariable2 = deg;
                    console.log(window.myGlobalVariable2);
                  }

                  var eltot = parseFloat($('#electricity_euro_disable').val() - window.myGlobalVariable2).toFixed(2);
                  tot += parseFloat((parseFloat($('#electricity_euro_disable').val()) - parseFloat(window.myGlobalVariable2)).toFixed(2));


                  // Define the HTML structure to be appended
                  const electricitySaving = `
                                                <div class="itemSnpage">
                                                    <span>
                                                        <i class="fa-solid fa-bolt"></i>
                                                        <h3>Electricity Saving:</h3>
                                                    </span>
                                                    <span class="price" id="electricity-save"><b>€`+ eltot + ` </b> Euro Per Year</span>

                                                </div>
                                            `;

                  // Append the sections to the main div
                  $('.addrow').append(electricitySaving);

                }
                if (input2Checked === "true") {
                  var estgas = $('#gas_kwh_disable').val();
                  var deg2 = (estgas * data2.gas_rate) + (data2.gas_standing_charge) + (((estgas * data2.gas_rate) + (data2.gas_standing_charge)) * 0.09);
                  window.myGlobalVariable22 = deg2;
                  console.log(window.myGlobalVariable22);

                  var gtot = parseFloat((parseFloat($('#gas_euro_disable').val()) - parseFloat(window.myGlobalVariable22)).toFixed(2));


                  const gasSaving = `
                                                <div class="itemSnpage">
                                                    <span>
                                                        <i class="fa-solid fa-fire"></i>
                                                        <h3>Gas Saving:</h3>
                                                    </span>
                                                    <span class="price resultssize" id="gas-save"><b>€`+ gtot + ` </b> Euro Per Year</span>

                                                </div>
                                            `;

                  $('.addrow').append(gasSaving);

                  tot += parseFloat((parseFloat($('#gas_euro_disable').val()) - parseFloat(window.myGlobalVariable22)).toFixed(2));
                }
                if (input3Checked === "true") {
                  var int = $('#internet_price').val();
                  var int1 = int * 12;
                  var intdeg = 30 * 12;
                  var inttot = int1 - intdeg;

                  var itot = inttot.toFixed(2);

                  const broadbandSaving = `
                                                <div class="itemSnpage">
                                                    <span>
                                                        <i class="fa-solid fa-wifi"></i>
                                                        <h3>Broadband Saving:</h3>
                                                    </span>
                                                    <span class="price" id="internet-save"><b>€`+ itot + ` </b> Euro Per Year</span>

                                                </div>
                                            `;

                  $('.addrow').append(broadbandSaving);

                  tot += parseFloat(inttot);


                }

                const elements = document.querySelectorAll('#total-save1, #eltot');

                elements.forEach(element => {
                  if (element.id === 'total-save1') {
                    element.innerText = "€" + tot.toFixed(2);
                  } else if (element.id === 'eltot') {
                    element.value = tot.toFixed(2);
                  }
                });

              },
              error: function (jqXHR, textStatus, errorThrown) {

                console.error(textStatus, errorThrown);
                alert('Error!');
              }
            });

          },
          error: function (jqXHR, textStatus, errorThrown) {

            console.error(textStatus, errorThrown);
            alert('Error!');
          },
          complete: function () {
            // Butonu orijinal durumuna döndür
            $('#submitButton').find('.indicator-label').show();
            $('#submitButton').find('.indicator-progress').hide();
          }
        });
      });
    });
  </script>

  <!-- safiye -->
  <!-- safiye -->
  <script>
    $(document).ready(function () {
      $('#gas_provider_id').change(function () {
        fetchGasDefaultTariffs();
      });


      function fetchGasCurrentTariffs() {
        $.ajax({
          url: "https://admin.onebill.ie/api/gasCurrentTariff",
          type: "POST",
          data: {
            tariff_id: $('#gas_tariff_name').val()
          },
          dataType: 'json',
          success: function (response) {
            //response.gas_standing_charge
            var est = $('#gas_kwh_disable').val();
            var deg = (est * response.gas_rate) + (response.gas_standing_charge) + (((est * response.gas_rate) + (response.gas_standing_charge)) * 0.09);
            window.myGlobalGasVariable = deg;
            console.log(window.myGlobalGasVariable);
            $('#gas_euro_disable').val(deg);

          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function fetchGasDefaultTariffs() {
        $.ajax({
          url: "https://admin.onebill.ie/api/gasDefaultTariff",
          type: "POST",
          data: {
            provider_id: $('#gas_provider_id').val(),
            mcc_id: 1
          },
          dataType: 'json',
          success: function (response) {

            var est = $('#gas_kwh_disable').val();
            var deg = (est * response.gas_rate) + (response.gas_standing_charge) + (((est * response.gas_rate) + (response.gas_standing_charge)) * 0.09);
            window.myGlobalGasVariable = deg;
            console.log(window.myGlobalGasVariable);
            $('#gas_euro_disable').val(deg);


          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function updateGasTariff() {
        if ($('#dontKnowGasTariffName').is(':checked')) {
          fetchGasDefaultTariffs();
        } else {
          fetchGasCurrentTariffs();
        }
      }

      $('#dontKnowGasTariffName').on('change', updateGasTariff);

      $('input[name="gas_kwh_disable"]').on('change', updateGasTariff);

      $('input[name="gas_kwh"]').on('change', updateGasTariff);

      $('#gas_tariff_name').on('change', fetchGasCurrentTariffs);

      if ($('#kwhCheckbox').is(':checked')) {
        updateGasTariff();
      }

      $('#gas_dontknowCheckbox').on('change', function () {
        if ($(this).is(':checked')) {
          updateGasTariff();
        }
      });

    });
  </script>

  <script>
    $(document).ready(function () {

      function fetchGasCurrentEuro() {
        $.ajax({
          url: "https://admin.onebill.ie/api/gasCurrentTariff",
          type: "POST",
          data: {
            tariff_id: $('#gas_tariff_name').val()
          },
          dataType: 'json',
          success: function (response) {
            var rate = response.gas_rate;
            var standing_charge = response.gas_standing_charge;
            var est = ($('#gas_euro_disable').val() - standing_charge * 1.09) / (rate * 1.09);
            $('#gas_kwh_disable').val(est);

          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function fetchGasDefaultEuro() {
        $.ajax({
          url: "https://admin.onebill.ie/api/gasDefaultTariff",
          type: "POST",
          data: {
            provider_id: $('#gas_provider_id').val()
          },
          dataType: 'json',
          success: function (response) {

            var rate = response.gas_rate;
            var standing_charge = response.gas_standing_charge;
            var est = ($('#gas_euro_disable').val() - standing_charge * 1.09) / (rate * 1.09);
            $('#gas_kwh_disable').val(est);

          },
          error: function (xhr, status, error) {
            console.error("Error fetching tariffs:", error);
          }
        });
      }

      function updateGasEuro() {
        if ($('#dontKnowGasTariffName').is(':checked')) {
          fetchGasDefaultEuro();
        } else {
          fetchGasCurrentEuro();
        }
      }

      $('#dontKnowGasTariffName').on('change', updateGasEuro);

      $('input[name="gas_euro_disable"]').on('change', updateGasEuro);

      $('input[name="gas_euro"]').on('change', updateGasEuro);

      if ($('#euroCheckbox').is(':checked')) {
        updateGasEuro();
      }

      // jQuery ile input alanının değişiklik olayı (change) yakalanır
      $('#gas_euro').on('input', function () {
        // electricity_euro alanının değeri alınır
        var euroValue = $(this).val();

        // alınan değer electricity_euro_disable alanına yazılır
        $('#egas_euro_disable').val(euroValue);

      });

      // jQuery ile input alanının değişiklik olayı (change) yakalanır
      $('#gas_kwh').on('input', function () {
        // electricity_euro alanının değeri alınır
        var kwhValue = $(this).val();

        // alınan değer electricity_euro_disable alanına yazılır
        $('#gas_kwh_disable').val(kwhValue);

      });

    });
  </script>

  <script>
    $("#signin").click(function () {
      let formData = {};

      // Tüm form elemanlarını seç ve dolaş
      $("#kt_create_account_form").find("input, textarea, select").each(function () {
        let element = $(this);
        let name = element.attr('name');
        let value;

        // Form eleman türüne göre değer alma
        if (element.is(":checkbox")) {
          // Checkbox grubu için değerleri dizi olarak saklama
          if (!formData[name]) {
            formData[name] = [];
          }
          if (element.prop("checked")) {
            formData[name].push(element.val());
          }
        } else if (element.is(":radio")) {
          if (element.prop("checked")) {
            formData[name] = element.val();
          }
        } else {
          formData[name] = element.val();
        }
      });

      // formData objesini localStorage'a kaydet
      for (let key in formData) {
        window.localStorage.setItem(key, formData[key]);
      }

      // Debug amaçlı console'a yazdır
      console.log(formData);
      let savedValue = window.localStorage.getItem('bundle_include');

      $('#kt_create_account_form').hide();
      $('#onebilStepsn2').show();
      $('#showhidesigninbutton').show()
      $('.app-content.bg-body-tertiary').addClass('paddingsignin');
      // var services = window.localStorage.getItem('services');
      //window.location.href = "onboarding-form.html" + services;  yönlendirmeyi steplere geçtiğimiz için iptal ediyoruz bunun yerine next step e geçiş yapacağız adımları
    });
    $('#showhidesigninbutton').on('click', function () {
      $('#kt_create_account_form').show();
      $('#onebilStepsn2').hide();
      $('#showhidesigninbutton').hide()
      $('.app-content.bg-body-tertiary').removeClass('paddingsignin');
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const radioButtons = document.querySelectorAll('input[name="bundle_part"]');
      const blockElement = document.querySelector('.blockDSn1');

      radioButtons.forEach(function (radioButton) {
        radioButton.addEventListener('change', function () {
          if (document.querySelector('.blockDSn1Kx').checked) {
            blockElement.style.display = 'block';
          } else {
            blockElement.style.display = 'none';
          }
        });
      });
    });
  </script>

  <script>
    $(document).ready(function () {

      var eircode = localStorage.getItem('eircode');
      var address = localStorage.getItem('address');
      $("#eir-code").val(eircode);
      $("#addressInput").val(address);
      $("#adressandeircode").text(address);

    });

  </script>



  <script>
    $(document).ready(function () {
      $('#gas_date_dont_know').change(function () {
        if ($(this).is(':checked')) {
          $('select[name="gas_month"]').prop('disabled', true).val('Month');
          $('select[name="gas_year"]').prop('disabled', true).val('Year');
        } else {
          $('select[name="gas_month"]').prop('disabled', false);
          $('select[name="gas_year"]').prop('disabled', false);
        }
      });

      // Sayfa yüklendiğinde checkbox seçili ise selectbox'ları devre dışı bırak
      if ($('#elec_date_dont_know').is(':checked')) {
        $('select[name="gas_month"]').prop('disabled', true).val('Month');
        $('select[name="gas_year"]').prop('disabled', true).val('Year');
      }
    });
  </script>

  <script>
    $('input[name="electricity_payment_type"]').on('click', function () {
      if ($(this).val() === 'payasyougo') {
        $('.payasyougovalidation').show();
      } else {
        $('.payasyougovalidation').hide();
      }
    });
  </script>

  <script>
    $('input[name="gas_payment_type"]').on('click', function () {
      if ($(this).val() === 'payasyougo') {
        $('.gaspayasyougovalidation').show();
      } else {
        $('.gaspayasyougovalidation').hide();
      }
    });
  </script>

  <!-- onboarding functions -->
  <script>
    function selectFirstOption() {
      const fontSelector = document.getElementById('fontSelector');
      fontSelector.selectedIndex = 0; // İlk seçeneği seçili hale getir
      fontSelector.dispatchEvent(new Event('change')); // change olayını tetikle
    }

    function updateFont() {


      const selectedFont = document.getElementById('fontSelector').value;
      const textInput = document.getElementById('signatureTextInput');


      // Stil ayarlarını 'important' olarak uygulama
      textInput.style.setProperty('font-family', selectedFont, 'important');


      setTimeout(() => {
        const text = textInput.value;
        const computedStyle = window.getComputedStyle(textInput);

        // Yeni bir canvas oluştur
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');

        // Font ve stil ayarlarını uygulama
        const fontSize = computedStyle.getPropertyValue('font-size');
        const fontFamily = selectedFont; // Font ailesini direkt seçilen font olarak al
        const fontWeight = computedStyle.getPropertyValue('font-weight');
        const fontStyle = computedStyle.getPropertyValue('font-style');
        const color = computedStyle.getPropertyValue('color');

        // Tüm font ve stil özelliklerini canvas'a uygulama
        context.font = `${fontStyle} ${fontWeight} ${fontSize} '${fontFamily}'`;
        context.fillStyle = color;
        context.textBaseline = 'top'; // Metni üst hizaya göre çiz

        // Metnin genişliğini ve yüksekliğini hesaplama
        const textWidth = context.measureText(text).width;
        const textHeight = parseInt(fontSize) * 1.2;

        // Canvas boyutlarını ayarlama
        canvas.width = textWidth;
        canvas.height = textHeight;

        // Font ve stil ayarlarını tekrar uygulama
        context.font = `${fontStyle} ${fontWeight} ${fontSize} '${fontFamily}'`;
        context.fillStyle = color;
        context.textBaseline = 'top'; // Metni üst hizaya göre çiz

        // Metni canvas'a çizme
        context.fillText(text, 0, 0);

        // PNG formatında veri URL'sini alma
        const dataURL = canvas.toDataURL('image/png');
        document.getElementById('signatureField').value = dataURL;
        // İmaj önizleme alanını güncelleme
        document.getElementById('signaturePreview').src = dataURL;
        // Tüm canvas'ı temizle
        context.clearRect(0, 0, canvas.width, canvas.height);
      }, 500);

    }

    $('#signin').click(function () {
      updateFont();
      $("#msform #name").val(window.localStorage.getItem('name'));
      $("#msform #house_type2").val(window.localStorage.getItem('house_type'));
      $("#msform #peopleNumber2").val(window.localStorage.getItem('peopleNumber'));
      $("#msform #bedroomNumber2").val(window.localStorage.getItem('bedroomNumber'));
      $("#msform #solarNumber2").val(window.localStorage.getItem('solarNumber'));
      $("#msform #batteriesNumber2").val(window.localStorage.getItem('batteriesNumber'));
      $("#msform #evNumber2").val(window.localStorage.getItem('evNumber'));
      $("#msform #have_smart_meter2").val(window.localStorage.getItem('have_smart_meter'));
      $("#msform #permission_esb_network2").val(window.localStorage.getItem('permission_esb_network'));
      $("#msform #best_describe2").val(window.localStorage.getItem('best_describe'));
      $("#msform #seai_ber2").val(window.localStorage.getItem('seai_ber'));
      $("#msform #responsible_for_paying2").val(window.localStorage.getItem('responsible_for_paying'));
      $("#msform #electricity_provider_id2").val(window.localStorage.getItem('electricity_provider_id'));
      $("#msform #electricity_payment_type2").val(window.localStorage.getItem('electricity_payment_type'));
      $("#msform #dg_type_id2").val(window.localStorage.getItem('dg_type_id'));
      $("#msform #mcc_id2").val(window.localStorage.getItem('mcc_id'));
      $("#msform #electricity_tariff_name2").val(window.localStorage.getItem('electricity_tariff_name'));
      $("#msform #dontKnowElectricityTariffName2").val(window.localStorage.getItem('dontKnowElectricityTariffName'));
      $("#msform #electricity_euro2").val(window.localStorage.getItem('electricity_euro'));
      $("#msform #tot2").val(window.localStorage.getItem('savings'));
      $("#msform #electricity_kwh2").val(window.localStorage.getItem('electricity_kwh'));
      $("#msform #internet_euro2").val(window.localStorage.getItem('internet_price'));
      $("#msform #gas_provider_id2").val(window.localStorage.getItem('gas_provider_id'));
      $("#msform #gas_payment_type2").val(window.localStorage.getItem('gas_payment_type'));
      $("#msform #heating_type2").val(window.localStorage.getItem('heating_type[]'));
      $("#msform #gas_tariff_name2").val(window.localStorage.getItem('gas_tariff_name'));
      $("#msform #gas_kwh2").val(window.localStorage.getItem('gas_kwh'));
      $("#msform #gas_euro2").val(window.localStorage.getItem('gas_euro'));
      $("#msform #internet_provider_id2").val(window.localStorage.getItem('internet_provider_id'));
      $("#msform #bundle_part2").val(window.localStorage.getItem('bundle_part'));
      $("#msform #bundle_include2").val(window.localStorage.getItem('bundle_include[]'));

      var selectElementBroadband = document.querySelector('#msform #broadband-provider');
      var matched = false;
      for (var i = 0; i < selectElementBroadband.options.length; i++) {
        if (selectElementBroadband.options[i].value === window.localStorage.getItem('internet_provider_id')) {
          selectElementBroadband.selectedIndex = i;
          matched = true;
          break;
        }
      }
      if (!matched) {
        document.querySelector('#msform #brd').style.display = 'block';
      }

      var selectElementElectricity = document.querySelector('#msform #electricity-provider');
      var matched1 = false;
      for (var i = 0; i < selectElementElectricity.options.length; i++) {
        if (selectElementElectricity.options[i].value === window.localStorage.getItem('electricity_provider_id')) {
          selectElementElectricity.selectedIndex = i;
          matched1 = true;
          break;
        }
      }
      if (!matched1) {
        document.querySelector('#msform #elc').style.display = 'block';
      }

      var selectElementGas = document.querySelector('#msform #gas-provider');
      var matched2 = false;
      for (var i = 0; i < selectElementGas.options.length; i++) {
        if (selectElementGas.options[i].value === window.localStorage.getItem('gas_provider_id')) {
          selectElementGas.selectedIndex = i;
          matched2 = true;
          break;
        }
      }
      if (!matched2) {
        document.querySelector('#msform #gs').style.display = 'block';
      }
      console.log(window.services);
      $('#msform input[name=surname]').keyup(function () {
        $('#msform #loaname1').text($('#msform #name').val() + " " + $(this).val());
        $('#msform #loaname2').text($('#msform #name').val() + " " + $(this).val());
        $('#msform #loaname3').text($('#msform #name').val() + " " + $(this).val());
      });

      $('#msform input[name=name]').keyup(function () {
        $('#msform #loaname1').text($(this).val() + " " + $('#msform #surname').val());
        $('#msform #loaname2').text($(this).val() + " " + $('#msform #surname').val());
        $('#msform #loaname3').text($(this).val() + " " + $('#msform #surname').val());
      });

      $('#msform input[name=address]').keyup(function () {
        $('#msform #loaaddress1').text($(this).val());
        $('#msform #loaaddress2').text($(this).val());
      });

      const date = new Date();
      let day = date.getDate();
      let month = date.getMonth() + 1;
      let year = date.getFullYear();
      day = day < 10 ? '0' + day : day;
      month = month < 10 ? '0' + month : month;
      let currentDate = `${day}-${month}-${year}`;
      $('#msform #date').text(currentDate);
      $('#msform #date2').text(currentDate);

      var eircode = localStorage.getItem('eircode');
      var tok = localStorage.getItem('tok');
      var email = localStorage.getItem('email');
      var addr = localStorage.getItem('address');
      $('#msform #eircode').val(eircode);
      $('#msform #token').val(tok);
      $('#msform #email').val(email);
      $('#msform #address').val(addr);
      $('#msform #loaaddress1').text(addr);
      $('#msform #loaaddress2').text(addr);
    });

    $('input[type=radio][name=want_electricity]').change(function () {
      if (this.value === '1') {
        $('.open_electricity_div').show();
      } else if (this.value === '0') {
        $('.open_electricity_div').hide();
      }
    });

    $('#msform input[type=radio][name=want_gas]').change(function () {
      if (this.value === '1') {
        $('#msform .open_gas_div').show();
      } else if (this.value === '0') {
        $('#msform .open_gas_div').hide();
      }
    });

    $('#msform input[type=radio][name=want_broadband]').change(function () {
      if (this.value === '1') {
        $('#msform .open_broadband_div').show();
      } else if (this.value === '0') {
        $('#msform .open_broadband_div').hide();
      }
    });

    $('#msform input[type=radio][name=solar-electricity]').change(function () {
      if (this.value === '1') {
        $('#msform .open_solar_div').show();
      } else if (this.value === '0') {
        $('#msform .open_solar_div').hide();
      }
    });
  </script>

  <link type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/south-street/jquery-ui.css"
    rel="stylesheet">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
  <script type="text/javascript" src="/js/utils/signature.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.0.7/js/swiper.min.js"></script>
  <link rel="stylesheet" href="/styles/signature.css">

  <script type="text/javascript">
    var signaturePad = $('#signature').signature({
      syncField: '#signatureField', syncFormat: 'PNG',
      change: function (event, ui) {
        $('#signatureImg').css('display', 'block').attr('src', $('#signatureField').val());
        $('#signatureImg2').css('display', 'block').attr('src', $('#signatureField').val());
      }
    });

    $('#clear').click(function (e) {
      e.preventDefault();
      signaturePad.signature('clear');
      $("#signatureField").val('');
      $('#signatureImg').css('display', 'none')
    });
  </script>

  <script>
    var onebilStepsn1 = document.getElementById("msform").querySelector("#onebilStepsn1");
    var onebilStepsn2 = document.getElementById("msform").querySelector("#onebilStepsn2");
    var onebilStepContent = document.getElementById("msform").querySelector("#onebilStepContent");
    var oneBilsstepUst1 = document.getElementById("msform").querySelector("#oneBilsstepUst1");
    var oneBilsstepUst2 = document.getElementById("msform").querySelector("#oneBilsstepUst2");
    var oneBilsstepUst3 = document.getElementById("msform").querySelector("#oneBilsstepUst3");
    var ilerleButton = document.getElementById("msform").querySelector("#ilerleButton");
    var backToonebilStepsn1Button = document.getElementById("msform").querySelector("#backToonebilStepsn1");
    var warningMessage = document.getElementById("msform").querySelector("#warningMessage");

    function selectOptions() {
      warningMessage.textContent = "";
      var selectedOptions = document.querySelectorAll("#msform .option:checked");
      if (selectedOptions.length === 0) {
        warningMessage.textContent = "En az bir seçenek işaretlenmelidir.";
        return;
      }
      onebilStepsn1.style.display = "none";
      onebilStepsn2.style.display = "block";
      hideoneBilsstepUsts();
      selectedOptions.forEach(function (option) {
        var oneBilsstepUstId = "oneBilsstepUst" + option.value.substr(-1);
        var selectedoneBilsstepUst = document.getElementById("msform").querySelector("#" + oneBilsstepUstId);
        if (selectedoneBilsstepUst) {
          selectedoneBilsstepUst.style.display = "block";
        }
      });

      backToonebilStepsn1Button.style.display = "block";
    }

    backToonebilStepsn1Button.addEventListener("click", function () {
      onebilStepsn2.style.display = "none";
      onebilStepsn1.style.display = "flex";
      backToonebilStepsn1Button.style.display = "none";
    });

    function hideoneBilsstepUsts() {
      var oneBilsstepUsts = document.querySelectorAll("#msform .onebilUstepCls");
      oneBilsstepUsts.forEach(function (oneBilsstepUst) {
        oneBilsstepUst.style.display = "none";
      });
    }

    ilerleButton.addEventListener("click", selectOptions);

    const checkboxValue1 = document.querySelector('#msform input[type="checkbox"][name="options"][value="1"]');
    if (checkboxValue1) {
      checkboxValue1.addEventListener('change', function () {
        if (this.checked) {
          document.querySelector('#msform #want_electricity-yes').checked = true;
        } else {
          document.querySelector('#msform #want_electricity-no').checked = true;
        }
      });
    }

    const ilerleButton = document.querySelector('#msform #ilerleButton');
    ilerleButton.addEventListener("click", selectOptions);
    document.querySelector('#msform #ilerleButton').addEventListener('click', function (event) {
      event.preventDefault();
    });

    const topButton = document.querySelector('#msform #backToonebilStepsn1');
    window.addEventListener('scroll', function () {
      if (window.scrollY > 300) {
        topButton.style.display = 'block';
      } else {
        topButton.style.display = 'none';
      }
    });

    topButton.addEventListener('click', function () {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });
  </script>
  <script>
    const checkboxValue2 = document.querySelector('#msform input[type="checkbox"][name="options"][value="2"]');
    if (checkboxValue2) {
      checkboxValue2.addEventListener('change', function () {
        if (this.checked) {
          document.querySelector('#msform #want_gas-yes').checked = true;
        } else {
          document.querySelector('#msform #want_gas-no').checked = true;
        }
      });
    }
  </script>
  <script>
    const checkboxValue3 = document.querySelector('#msform input[type="checkbox"][name="options"][value="3"]');
    if (checkboxValue3) {
      checkboxValue3.addEventListener('change', function () {
        if (this.checked) {
          document.querySelector('#msform #want_broadband-yes').checked = true;
        } else {
          document.querySelector('#msform #want_broadband-no').checked = true;
        }
      });
    }
  </script>
  <script>
    var swiper = new Swiper("#scaefy-swiper", {
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      autoplay: {
        delay: 4000,
        disableOnInteraction: false,
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,

      },
      breakpoints: {
        0: {
          slidesPerView: 11,
          spaceBetween: 20,
        },
        767: {
          slidesPerView: 1,
          spaceBetween: 24,
        },
        988: {
          slidesPerView: 1,
          spaceBetween: 48,
        },
      },
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      var ilerleButton = document.querySelector('#msform #ilerleButton');
      var backToonebilStepsn1Button = document.querySelector('#msform #backToonebilStepsn1');

      ilerleButton.addEventListener('click', function () {
        var dateSecinput = document.querySelector('#msform .dateSecinput');
        dateSecinput.style.display = 'none';
      });

      backToonebilStepsn1Button.addEventListener('click', function () {
        var dateSecinput = document.querySelector('#msform .dateSecinput');
        dateSecinput.style.display = 'block';
      });
    });
  </script>
  <script>
    function checkPassword() {
      var password = document.querySelector('#msform #password').value;
      var confirmPassword = document.querySelector('#msform #confirmpassword').value;
      var messageElement = document.querySelector('#msform #passwordMatchMessage');
      var icon = $('.password-wrapper.confirm i');

      // Check match only if both fields have values
      if (password && confirmPassword) {
        // If passwords match, clear message and add check mark
        if (password === confirmPassword) {
          messageElement.innerHTML = "";
          icon.addClass('ischecked').removeClass('is-invalid');
        } else {
          // Show error if passwords don't match
          messageElement.innerHTML = "Passwords do not match. Please try again.";
          icon.removeClass('ischecked').addClass('is-invalid');
        }
      }
    }

    // Validate confirm password only on blur
    document.querySelector('#msform #confirmpassword').addEventListener("blur", checkPassword);

    // Clear the error as soon as confirm password matches after correction
    document.querySelector('#msform #confirmpassword').addEventListener("input", function () {
      var password = document.querySelector('#msform #password').value;
      var confirmPassword = document.querySelector('#msform #confirmpassword').value;
      var messageElement = document.querySelector('#msform #passwordMatchMessage');
      var icon = $('.password-wrapper.confirm i');

      // Remove error message if passwords match during input
      if (password === confirmPassword) {
        messageElement.innerHTML = "";
        icon.addClass('ischecked').removeClass('is-invalid');
      }
    });
  </script>

  <script>
    const checkboxes = document.querySelectorAll('#msform .slectCkbox');
    const solarCheckbox = document.querySelector('#msform .secplat1adg');
    const noCheckbox = document.querySelector('#msform .secplat1adNo');
    const cardsg1Frm = document.querySelector('#msform .cardsg1Frm');
    const cardsg2Frm = document.querySelector('#msform .cardsg2Frm');
    const cardsg3Frm = document.querySelector('#msform .cardsg3Frm');

    function updateDisplay() {
      const checkedCheckboxes = document.querySelectorAll('#msform .slectCkbox:checked');
      const isSolarElectricitySelected = solarCheckbox.checked;
      const isNoCheckboxSelected = noCheckbox.checked;

      if (isNoCheckboxSelected) {
        cardsg1Frm.style.display = 'block';
        cardsg2Frm.style.display = 'none';
        cardsg3Frm.style.display = 'none';
      } else if (checkedCheckboxes.length <= 3 && isSolarElectricitySelected) {
        cardsg1Frm.style.display = 'none';
        cardsg2Frm.style.display = 'block';
        cardsg3Frm.style.display = 'none';
      } else if (checkedCheckboxes.length <= 3) {
        cardsg1Frm.style.display = 'block';
        cardsg2Frm.style.display = 'none';
        cardsg3Frm.style.display = 'none';
      } else {
        cardsg1Frm.style.display = 'none';
        cardsg2Frm.style.display = 'none';
        cardsg3Frm.style.display = 'none';
      }
    }

    updateDisplay();

    var ilerleButton = document.querySelector('#msform #ilerleButton');
    ilerleButton.addEventListener('click', function () {
      document.documentElement.scrollTop = 0;
      document.body.scrollTop = 0;
    });
  </script>

  <script>
    function sendSMS() {
      var name = document.querySelector('#msform #name').value;
      var surname = document.querySelector('#msform #surname').value;
      var dateOfBirth = document.querySelector('#msform #dateofbirth').value;
      var gender = document.querySelector('#msform #gender').value;
      var phone = document.querySelector('#msform #phone').value;

      var missingFields = [];

      if (!name) missingFields.push('Name');
      if (!surname) missingFields.push('Surname');
      if (!dateOfBirth) missingFields.push('Date of Birth');
      if (!gender) missingFields.push('Gender');

      if (missingFields.length > 0) {
        alert('Please fill in the following fields: ' + missingFields.join(', '));
        return;
      }

      $.ajax({
        type: 'POST',
        url: 'https://admin.onebill.ie/api/verification-code',
        data: { phone: phone },
        success: function (response) {
          var message = response.message;
          if (message == '111') {
            document.querySelector('#msform #verificationSection').style.display = 'block';
            document.querySelector('#msform #sendsmsbutton').style.display = 'none';
          } else {
            alert('SMS sending failed, check your number and try again.');
          }
        },
        error: function (error) {
          console.error('Error:', error);
        }
      });
    }
  </script>
  <script>
    function checkSMS() {
      var phone = document.querySelector('#msform #phone').value;
      var code = document.querySelector('#msform #verificationCode').value;

      $.ajax({
        type: 'POST',
        url: 'https://admin.onebill.ie/api/verification',
        data: { phone: phone, code: code },
        success: function (response) {
          var message = response.message;
          if (message == '111') {
            document.querySelector('#msform #loaSection').style.display = 'block';
            document.querySelector('#msform #checksmsbutton').style.display = 'none';
            document.querySelector('#msform .questcall').style.display = 'flex';
          } else {
            alert('Verification Failed!');
            document.querySelector('#msform #verificationSection').style.display = 'none';
            document.querySelector('#msform #sendsmsbutton').value = "Resend Code";
            document.querySelector('#msform #verificationCode').value = "";
            document.querySelector('#msform #sendsmsbutton').style.display = 'block';
          }
        },
        error: function (error) {
          console.error('Error:', error);
        }
      });
    }
  </script>
  <script>
    document.querySelector('#msform #localphone').addEventListener('input', function (e) {
      // Kullanıcı girişini al ve sadece rakamları içerecek şekilde formatla
      var input = e.target.value.replace(/\D/g, '');

      // Telefon numarasının başındaki '0' karakterini kaldır
      if (input.startsWith('0')) {
        input = input.substring(1);
      }

      // '+353 ' ön ekini ekle
      var internationalFormat = '+353 ';

      // Alan kodunu (ilk iki hane) ekle ve ardından bir boşluk koy
      if (input.length > 2) {
        internationalFormat += input.substring(0, 2) + ' ';
        input = input.substring(2);
      }

      // Sonraki üç hane
      if (input.length > 3) {
        internationalFormat += input.substring(0, 3) + ' ';
        input = input.substring(3);
      }

      // Kalan tüm haneler
      if (input.length > 0) {
        internationalFormat += input;
      }

      // Dönüştürülmüş numarayı arkaplandaki input'a yaz
      document.querySelector('#msform #phone').value = internationalFormat;
    });
  </script>
  <script>
    // Query string'den parametreleri al
    const params = new URLSearchParams(window.location.search);
    const input1Checked = params.get('input1');
    const input2Checked = params.get('input2');
    const input3Checked = params.get('input3');

    // Alınan parametrelere göre checkbox'ları işaretle
    if (input1Checked === "true") {
      document.querySelector('#msform #input1').checked = true;
      document.querySelector('#msform #want_electricity-yes').checked = true;
    }
    if (input2Checked === "true") {
      document.querySelector('#msform #input2').checked = true;
      document.querySelector('#msform #want_gas-yes').checked = true;
    }
    if (input3Checked === "true") {
      document.querySelector('#msform #input3').checked = true;
      document.querySelector('#msform #want_broadband-yes').checked = true;
    }
    if (input1Checked === "true" || input2Checked === "true" || input3Checked === "true") {
      document.querySelector('#msform #ilerleButton').click();
    }

    document.querySelector('#msform #redirectButton2').addEventListener("click", function () {
      window.location.href = "index.html#formSingaHref";
    });
  </script>
  <script>
    function opensingTabsnw(evt, singTabsnwName) {
      var i, signaturesingTabsnwcontent, singTabsnwlinks;
      signaturesingTabsnwcontent = document.querySelectorAll('#msform .signaturesingTabsnwcontent');
      for (i = 0; i < signaturesingTabsnwcontent.length; i++) {
        signaturesingTabsnwcontent[i].style.display = "none";
      }
      singTabsnwlinks = document.querySelectorAll('#msform .singTabsnwlinks');
      for (i = 0; i < singTabsnwlinks.length; i++) {
        singTabsnwlinks[i].className = singTabsnwlinks[i].className.replace(" active", "");
      }
      document.querySelector('#msform #' + singTabsnwName).style.display = "block";
      evt.currentTarget.className += " active";

      if (singTabsnwName === 'singTabsnwText') {
        clearText();
      }
    }
  </script>
  <script>
    // IBAN input alanını seçin
    var ibanInput = document.querySelector('#msform #iban');
    var shouldValidateLive = false; // Canlı doğrulama modunu izlemek için bir değişken

    // Input alanından çıkıldığında (blur) çalışacak fonksiyon
    ibanInput.addEventListener('blur', function () {
      alertValidIBAN(this.value);
    });

    // Input alanında her değişiklik olduğunda çalışacak fonksiyon
    ibanInput.addEventListener('input', function () {
      // Convert the input value to uppercase
      this.value = this.value.toUpperCase();

      if (shouldValidateLive) {
        alertValidIBAN(this.value);
      }
    });

    function alertValidIBAN(iban) {
      var res = isValidIBANNumber(iban);
      if (!res) {
        document.querySelector('#msform .uyari').style.display = 'block';
        shouldValidateLive = true; // Canlı doğrulama modunu aktif et
      } else {
        document.querySelector('#msform .uyari').style.display = 'none';
        shouldValidateLive = false; // Canlı doğrulama modunu pasif et
      }
    }

    function isValidIBANNumber(input) {
      var CODE_LENGTHS = {
        AD: 24,
        AE: 23,
        AT: 20,
        AZ: 28,
        BA: 20,
        BE: 16,
        BG: 22,
        BH: 22,
        BR: 29,
        CH: 21,
        CR: 21,
        CY: 28,
        CZ: 24,
        DE: 22,
        DK: 18,
        DO: 28,
        EE: 20,
        ES: 24,
        FI: 18,
        FO: 18,
        FR: 27,
        GB: 22,
        GI: 23,
        GL: 18,
        GR: 27,
        GT: 28,
        HR: 21,
        HU: 28,
        IE: 22,
        IL: 23,
        IS: 26,
        IT: 27,
        JO: 30,
        KW: 30,
        KZ: 20,
        LB: 28,
        LI: 21,
        LT: 20,
        LU: 20,
        LV: 21,
        MC: 27,
        MD: 24,
        ME: 22,
        MK: 19,
        MR: 27,
        MT: 31,
        MU: 30,
        NL: 18,
        NO: 15,
        PK: 24,
        PL: 28,
        PS: 29,
        PT: 25,
        QA: 29,
        RO: 24,
        RS: 22,
        SA: 24,
        SE: 24,
        SI: 19,
        SK: 24,
        SM: 27,
        TN: 24,
        TR: 26,
        AL: 28,
        BY: 28,
        CR: 22,
        EG: 29,
        GE: 22,
        IQ: 23,
        LC: 32,
        SC: 31,
        ST: 25,
        SV: 28,
        TL: 23,
        UA: 29,
        VA: 22,
        VG: 24,
        XK: 20
      };
      var iban = String(input).toUpperCase().replace(/[^A-Z0-9]/g, ''),
        code = iban.match(/^([A-Z]{2})(\d{2})([A-Z\d]+)$/),
        digits;
      if (!code || iban.length !== CODE_LENGTHS[code[1]]) {
        return false;
      }
      digits = (code[3] + code[1] + code[2]).replace(/[A-Z]/g, function (letter) {
        return letter.charCodeAt(0) - 55;
      });
      return mod97(digits) === 1;
    }

    function mod97(string) {
      var checksum = string.slice(0, 2),
        fragment;
      for (var offset = 2; offset < string.length; offset += 7) {
        fragment = String(checksum) + string.substring(offset, offset + 7);
        checksum = parseInt(fragment, 10) % 97;
      }
      return checksum;
    }
  </script>

  <script>
    $(document).ready(function () {
      // Maximum IBAN length (depends on country, but max is 34)
      const MAX_IBAN_LENGTH = 34;

      // Regular expression for a general IBAN structure (not country-specific, adjust as needed)
      const ibanRegex = /^[A-Z]{2}[0-9]{2}[A-Z0-9]{1,30}$/;

      // Event listener for IBAN input field (converts to uppercase on input)
      $('#ibanInput').on('input', function () {
        let ibanValue = $(this).val();

        // Remove spaces and convert to uppercase for consistent validation
        ibanValue = ibanValue.replace(/\s+/g, '').toUpperCase();

        // Set the input value to the formatted IBAN (uppercase, without spaces)
        $(this).val(ibanValue);
      });

      // Event listener to validate IBAN on blur (when user moves out of the field)
      $('#ibanInput').on('blur', function () {
        validateIban($(this).val());
      });

      // Function to validate IBAN format and length
      function validateIban(iban) {
        const ibanError = $('#ibanError');

        // Check IBAN length
        if (iban.length > MAX_IBAN_LENGTH) {
          ibanError.text('IBAN exceeds the maximum length of ' + MAX_IBAN_LENGTH + ' characters.');
          ibanError.show();
        }
        // Check IBAN format using regex
        else if (!ibanRegex.test(iban)) {
          ibanError.text('Invalid IBAN. Please check the format and length.');
          ibanError.show();
        } else {
          ibanError.hide(); // Hide error if valid
        }
      }
    });
  </script>
  <script>
    function validateIBAN() {
      const iban = document.getElementById('iban').value;
      const errorMessage = document.querySelector('.uyari');

      if (!iban) {
        errorMessage.style.display = 'none';
        return;
      }

      // Use the OpenIBAN API
      fetch(`https://openiban.com/validate/${iban}?getBIC=true&validateBankCode=true`)
        .then(response => response.json())
        .then(data => {
          if (data.valid) {
            errorMessage.style.display = 'none';
            // Optionally, you can perform actions if the IBAN is valid
            console.log("IBAN is valid:", data);
          } else {
            errorMessage.style.display = 'block';
            // Optionally, you can perform actions if the IBAN is invalid
            console.log("IBAN is invalid");
          }
        })
        .catch(error => {
          console.error('Error validating IBAN:', error);
          errorMessage.style.display = 'block';
        });
    }
  </script>

  <script>
    document.querySelector('#msform #ibanForm').addEventListener('submit', function (event) {
      var iban = document.querySelector('#msform #iban').value;
      if (!isValidIBANNumber(iban)) {
        document.querySelector('#msform .uyari').textContent = "Invalid IBAN! Please check your input.";
        document.querySelector('#msform .uyari').style.display = 'block';
        event.preventDefault();

        alert("Invalid IBAN! Please check your input.");
      } else {
        document.querySelector('#msform .uyari').style.display = 'none';
      }

      var password = document.querySelector('#msform #password').value;
      var confirmPassword = document.querySelector('#msform #confirmpassword').value;

      if (password !== confirmPassword) {
        event.preventDefault();
        alert("Passwords do not match.");
      }
    });
  </script>

  <script>
    $(document).ready(function () {
      $('.select-btn').click(function () {
        var value = $(this).data('value');
        $('#first_payment_date').val(value);
        $('.select-btn').removeClass('active');
        $(this).addClass('active');
      });
    });
  </script>
  <script>
    $(document).ready(function () {
      // No toggle action on IBAN input based on the checkbox state
      $('#mandatecheck').change(function () {
        if ($(this).is(':checked')) {
          // You can add any additional functionality here, if needed, but it won't hide/show IBAN
          console.log('Checkbox checked');
        } else {
          console.log('Checkbox unchecked');
        }
      });
    });
  </script>
  <script>
    $(document).ready(function () {
      $(function () {
        $('[data-toggle="tooltip-spec"]').tooltip().on('inserted.bs.tooltip', function () {
          var tooltipId = $(this).attr('aria-describedby');
          $('#' + tooltipId).addClass('tooltip-spec');
        });
      });
    });
  </script>
  <script>
    $(document).ready(function () {
      $('#msform #password').on('input', function () {
        var password = $(this).val();
        var score = validatePassword(password);
        updateBackgroundColor(score, password);
        displaySpaceWarning(password); // Check for spaces dynamically
      });

      $('#msform #password').on('blur', function () {
        var password = $(this).val();
        displayMissingRequirements(password);
      });

      function validatePassword(password) {
        var score = 0;
        var hasUpperCase = /[A-Z]/.test(password);
        var hasLowerCase = /[a-z]/.test(password);
        var hasNumber = /\d/.test(password);
        var hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);
        var isLongEnough = password.length >= 8;
        var hasNoSpaces = !/\s/.test(password);

        if (hasUpperCase) score++;
        if (hasLowerCase) score++;
        if (hasNumber) score++;
        if (hasSpecialChar) score++;
        if (isLongEnough) score++;

        return score;
      }

      function updateBackgroundColor(score, password) {
        var checker = $('.password-validation-checker');
        var icon = $('.password-wrapper.noconfirm i');
        var color;

        if (score === 5) {
          color = 'green';
          icon.addClass('ischecked');
        } else if (score === 4) {
          color = 'lightgreen';
          icon.removeClass('ischecked');
        } else if (score === 3) {
          color = 'yellow';
          icon.removeClass('ischecked');
        } else if (score === 2) {
          color = 'orange';
          icon.removeClass('ischecked');
        } else if (score === 1) {
          color = 'red';
          icon.removeClass('ischecked');
        } else {
          color = 'red';
          icon.removeClass('ischecked');
        }

        var width = (score / 5) * 100 + '%';
        checker.css({
          'background-color': color,
          'width': width
        });
        console.log(`Background color: ${color}, Width: ${width}`);
      }

      function displaySpaceWarning(password) {
        var errorList = $('#passwordmatchresult');
        if (/\s/.test(password)) {
          if (!errorList.find('li:contains("Spaces are not allowed.")').length) {
            errorList.append('<li>Spaces are not allowed.</li>');
          }
        } else {
          errorList.find('li:contains("Spaces are not allowed.")').remove();
        }
      }

      function displayMissingRequirements(password) {
        var errorList = $('#passwordmatchresult');
        errorList.empty(); // Clear previous messages

        var hasUpperCase = /[A-Z]/.test(password);
        var hasLowerCase = /[a-z]/.test(password);
        var hasNumber = /\d/.test(password);
        var hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);
        var isLongEnough = password.length >= 8;
        var hasNoSpaces = !/\s/.test(password);

        if (!hasUpperCase) errorList.append('<li>Must contain an uppercase letter.</li>');
        if (!hasLowerCase) errorList.append('<li>Must contain a lowercase letter.</li>');
        if (!hasNumber) errorList.append('<li>Must contain a number.</li>');
        if (!hasSpecialChar) errorList.append('<li>Must contain a special character.</li>');
        if (!isLongEnough) errorList.append('<li>Must be at least 8 characters long.</li>');
        if (!hasNoSpaces) errorList.append('<li>Spaces are not allowed.</li>');
      }
    });




  </script>
  <script>
    function formatAndValidateDateOfBirth(input) {
      var value = input.value.replace(/\D/g, '');
      var formattedValue = '';

      if (value.length > 0) {
        formattedValue += value.substring(0, 2);
      }
      if (value.length > 2) {
        formattedValue += '/' + value.substring(2, 4);
      }
      if (value.length > 4) {
        formattedValue += '/' + value.substring(4, 8);
      }

      input.value = formattedValue;

      var regex = /^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/;
      var errorElement = document.getElementById('dateofbirth-error');

      if (formattedValue.length === 10) {
        var parts = formattedValue.split('/');
        var day = parseInt(parts[0], 10);
        var month = parseInt(parts[1], 10);
        var year = parseInt(parts[2], 10);
        var currentYear = new Date().getFullYear();

        if (!regex.test(formattedValue) || year >= currentYear) {
          errorElement.style.display = 'block';
        } else {
          errorElement.style.display = 'none';
        }
      } else {
        errorElement.style.display = 'none';
      }
    }
  </script>
  <!-- date of birth validation -->
  <script>
    function formatAndValidateDateOfBirth(input) {
      const oldPosition = input.selectionStart;
      const oldValue = input.value;
      let value = input.value.replace(/\D/g, ''); // Remove non-digits
      let formattedValue = '';

      if (value.length > 4) {
        formattedValue = value.substring(0, 2) + '/' + value.substring(2, 4) + '/' + value.substring(4, 8);
      } else if (value.length > 2) {
        formattedValue = value.substring(0, 2) + '/' + value.substring(2);
      } else {
        formattedValue = value;
      }

      input.value = formattedValue;

      // Adjust cursor position after formatting
      adjustCursorPosition(input, oldPosition, oldValue, formattedValue);

      // Validate the date when the full date is entered
      if (formattedValue.length === 10) {
        validateDate(formattedValue);
      }
    }

    function adjustCursorPosition(input, oldPosition, oldValue, formattedValue) {
      // Calculate new cursor position
      let newPosition = oldPosition;

      if (oldValue.length < formattedValue.length) { // Character added
        if (oldPosition === 3 || oldPosition === 6) {
          newPosition = oldPosition + 1; // Adjust for slashes
        }
      } else if (oldValue.length > formattedValue.length) { // Character removed
        // Adjust based on whether deletion occurred directly before a slash
        if (oldPosition === 3 || oldPosition === 6) {
          newPosition = oldPosition - 1;
        }
      }

      input.setSelectionRange(newPosition, newPosition);
    }

    function validateDate(value) {
      const errorMessage = document.getElementById('dateofbirth-error');
      const regex = /^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/(19|20)\d{2}$/;

      if (value.match(regex)) {
        const parts = value.split('/');
        const day = parseInt(parts[0], 10);
        const month = parseInt(parts[1], 10);
        const year = parseInt(parts[2], 10);
        const currentDate = new Date();
        const dateOfBirth = new Date(year, month - 1, day);

        if (dateOfBirth.getDate() === day && dateOfBirth.getMonth() + 1 === month && dateOfBirth.getFullYear() === year && dateOfBirth <= currentDate) {
          errorMessage.style.display = 'none';
          return;
        }
      }

      errorMessage.style.display = 'block';
      errorMessage.textContent = 'Please enter a valid date.';
    }

    document.addEventListener("DOMContentLoaded", function () {
      const dateInput = document.getElementById('dateofbirth');
      dateInput.addEventListener('input', function () {
        formatAndValidateDateOfBirth(this);
      });
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var tok = localStorage.getItem('tok');
      const paymentPeriodSelect = document.getElementById('payment_period');
      const annualPaymentInfo = document.getElementById('annual-payment-info');
      const monthlyPaymentOptions = document.getElementById('monthly-payment-options');


      paymentPeriodSelect.addEventListener('change', function () {
        const selectedValue = this.value;

        if (selectedValue === 'Yearly') {
          annualPaymentInfo.style.display = 'block';
          monthlyPaymentOptions.style.display = 'none';
        } else if (selectedValue === 'Monthly') {
          annualPaymentInfo.style.display = 'none';
          monthlyPaymentOptions.style.display = 'block';
        } else {

          annualPaymentInfo.style.display = 'none';
          monthlyPaymentOptions.style.display = 'none';
        }
      });


      const selectBtns = document.querySelectorAll('.fee-payment-button-wrapper .select-btn');
      const paymentDateSelect = document.getElementById('first_payment_date');

      selectBtns.forEach(function (btn) {
        btn.addEventListener('click', function () {
          paymentDateSelect.value = btn.getAttribute('data-value');
        });
      });
    });
  </script>
  <script>
    function checkPassword() {
      var password = document.querySelector('#msform #password').value;
      var confirmPassword = document.querySelector('#msform #confirmpassword').value;
      var messageElement = document.querySelector('#msform #passwordMatchMessage');
      var icon = $('.password-wrapper.confirm i');

      // Only show message when both fields are filled
      if (password && confirmPassword) {
        if (password === confirmPassword) {
          messageElement.innerHTML = "";
          icon.addClass('ischecked');
        } else {
          messageElement.innerHTML = "Passwords do not match. Please try again.";
          icon.removeClass('ischecked');
        }
      }
    }

    // Only check match when confirm password loses focus
    document.querySelector('#msform #confirmpassword').addEventListener("blur", checkPassword);

    // Optionally, clear any error when the user starts typing a new password
    document.querySelector('#msform #password').addEventListener("input", function () {
      var messageElement = document.querySelector('#msform #passwordMatchMessage');
      var icon = $('.password-wrapper.confirm i');

      // Clear the error message and the check icon when typing in the password field
      messageElement.innerHTML = "";
      icon.removeClass('ischecked');
    });
  </script>
  <script>
    $(document).ready(function () {
      var isPasswordValid = false;
      var isPasswordMatched = false;

      // Validate password strength and update UI
      $('#password').on('input', function () {
        var password = $(this).val();
        var score = validatePassword(password);
        updateBackgroundColor(score);
        displayMissingRequirements(password);

        // Mark password as valid or invalid based on score
        if (score === 5) {
          isPasswordValid = true;
          $('#confirmpassword').prop('disabled', false); // Enable the Confirm Password field
        } else {
          isPasswordValid = false;
          // Don't disable the confirm password field, just show feedback
          $('#confirmpassword').prop('disabled', false); // Keep it always enabled
        }
      });

      // On blur, show error if password is invalid, but don't trap focus
      $('#password').on('blur', function () {
        if (!isPasswordValid && $(this).val() !== "") {
          $('#password').addClass('is-invalid'); // Highlight invalid input
          $('#password').siblings('.invalid-feedback').show(); // Show error message
        } else {
          $('#password').removeClass('is-invalid');
          $('#password').siblings('.invalid-feedback').hide();
        }
      });

      // Check for password match only when confirm password input loses focus
      $('#confirmpassword').on('blur', function () {
        checkPasswordMatch(); // Validate password matching
      });

      // Function to validate password strength based on different conditions
      function validatePassword(password) {
        var score = 0;
        var hasUpperCase = /[A-Z]/.test(password);
        var hasLowerCase = /[a-z]/.test(password);
        var hasNumber = /\d/.test(password);
        var hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);
        var isLongEnough = password.length >= 8;

        if (hasUpperCase) score++;
        if (hasLowerCase) score++;
        if (hasNumber) score++;
        if (hasSpecialChar) score++;
        if (isLongEnough) score++;

        return score;
      }

      // Function to visually update the background color of the password strength bar
      function updateBackgroundColor(score) {
        var checker = $('.password-validation-checker');
        var color;

        if (score === 5) {
          color = 'green'; // Full strength
        } else if (score === 4) {
          color = 'lightgreen';
        } else if (score === 3) {
          color = 'yellow';
        } else if (score === 2) {
          color = 'orange';
        } else {
          color = 'red'; // Weak password
        }

        var width = (score / 5) * 100 + '%';
        checker.css({
          'background-color': color,
          'width': width
        });
      }

      // Function to display any missing password requirements
      function displayMissingRequirements(password) {
        var errorList = $('#passwordmatchresult');
        errorList.empty(); // Clear previous messages

        var hasUpperCase = /[A-Z]/.test(password);
        var hasLowerCase = /[a-z]/.test(password);
        var hasNumber = /\d/.test(password);
        var hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/.test(password);
        var isLongEnough = password.length >= 8;

        if (!hasUpperCase) errorList.append('<li>Must contain an uppercase letter.</li>');
        if (!hasLowerCase) errorList.append('<li>Must contain a lowercase letter.</li>');
        if (!hasNumber) errorList.append('<li>Must contain a number.</li>');
        if (!hasSpecialChar) errorList.append('<li>Must contain a special character.</li>');
        if (!isLongEnough) errorList.append('<li>Must be at least 8 characters long.</li>');
      }

      // Function to check if the password and confirm password match
      function checkPasswordMatch() {
        var password = $('#password').val();
        var confirmPassword = $('#confirmpassword').val();
        var messageElement = $('#confirmpassword').siblings('.invalid-feedback'); // Use siblings for confirm password error

        // Only show the error if both fields are filled
        if (password !== confirmPassword && confirmPassword.length > 0) {
          isPasswordMatched = false;
          messageElement.text('Passwords do not match.').show(); // Show error message for confirm password
          $('#confirmpassword').addClass('is-invalid');
        } else {
          isPasswordMatched = true;
          messageElement.hide(); // Hide error message
          $('#confirmpassword').removeClass('is-invalid');
        }
      }
    });

  </script>
  <script>
    // Email validation regex
    const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

    // Function to validate email only on blur
    function validateEmail() {
      const emailInput = document.getElementById('email');
      const emailError = document.getElementById('emailError');

      // Show or hide the error message based on email format
      if (!emailPattern.test(emailInput.value)) {
        emailError.style.display = 'block';
        emailInput.classList.add('is-invalid');
      } else {
        emailError.style.display = 'none';
        emailInput.classList.remove('is-invalid');
      }
    }

    // Function to validate address (basic check: not empty)
    function validateAddress() {
      const addressInput = document.getElementById('address');
      const addressError = document.getElementById('addressError');

      // Show or hide the error message based on address input
      if (addressInput.value.trim() === "") {
        addressError.style.display = 'block';
        addressInput.classList.add('is-invalid');
      } else {
        addressError.style.display = 'none';
        addressInput.classList.remove('is-invalid');
      }
    }

    // Attach blur event for email validation
    document.getElementById('email').addEventListener('blur', validateEmail);

    // Attach blur event for address validation
    document.getElementById('address').addEventListener('blur', validateAddress);

    // Form submission validation
    document.querySelector('form').addEventListener('submit', function (event) {
      // Validate both email and address before submission
      validateEmail();
      validateAddress();

      // Check if any errors are visible
      const emailErrorVisible = document.getElementById('emailError').style.display === 'block';
      const addressErrorVisible = document.getElementById('addressError').style.display === 'block';

      // Prevent form submission if there are errors
      if (emailErrorVisible || addressErrorVisible) {
        event.preventDefault();
      }
    });
  </script>

  <script>
    // Eircode validation regex: strictly uppercase, no spaces, correct format
    const eircodePattern = /^[A-Z]\d{2}[A-Z0-9]{4}$/;

    // Function to format Eircode in real-time
    function formatEircode() {
      const eircodeInput = document.getElementById('eircode');
      // Remove spaces and convert to uppercase
      eircodeInput.value = eircodeInput.value.replace(/\s+/g, '').toUpperCase();
    }

    // Function to validate Eircode
    function validateEircode() {
      const eircodeInput = document.getElementById('eircode');
      const eircodeError = document.getElementById('eircodeError');

      // Show or hide the error message based on Eircode format
      if (!eircodePattern.test(eircodeInput.value.trim())) {
        eircodeError.style.display = 'block';
        eircodeInput.classList.add('is-invalid');
      } else {
        eircodeError.style.display = 'none';
        eircodeInput.classList.remove('is-invalid');
      }
    }

    // Attach input event for real-time formatting
    document.getElementById('eircode').addEventListener('input', formatEircode);

    // Attach blur event for Eircode validation
    document.getElementById('eircode').addEventListener('blur', validateEircode);
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const signupButton = document.getElementById('signupButton');
      // Exclude signature-related fields (textarea and other signature elements)
      const allFields = document.querySelectorAll(
        '#step2 input:not(#signatureField, #signatureTextInput), #step2 select, #step2 textarea:not(#signatureField, #signatureField2, #signatureField3)'
      );
      const checkboxes = document.querySelectorAll('#termscheck, #loacheck, #mandatecheck');
      const passwordField = document.getElementById('password');
      const confirmPasswordField = document.getElementById('confirmpassword');
      const passwordMatchMessage = document.getElementById('passwordMatchMessage');
      const emailField = document.getElementById('email');
      const eircodeField = document.getElementById('eircode');
      const ibanField = document.getElementById('ibanInput');
      const emailError = document.getElementById('emailError');
      const eircodeError = document.getElementById('eircodeError');
      const ibanError = document.getElementById('ibanError');

      // Email, eircode, and IBAN validation regex patterns
      const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      const eircodePattern = /^[A-Za-z0-9]{7}$/; // Assuming a generic Eircode format
      const ibanPattern = /^[A-Z]{2}[0-9A-Z]{13,32}$/; // A simplified IBAN pattern (adjust as needed)

      // Function to check if all fields are filled, checkboxes are checked, passwords match, and email/eircode/iban are valid
      function checkFormCompletion() {
        let allFilled = true;
        let passwordsMatch = passwordField.value === confirmPasswordField.value;
        let validEmail = emailPattern.test(emailField.value);
        let validEircode = eircodePattern.test(eircodeField.value);
        let validIban = ibanPattern.test(ibanField.value);

        // Check if all fields have a value
        allFields.forEach(function (field) {
          // Skip hidden fields
          if (field.type !== 'hidden' && field.style.display !== 'none' && field.value.trim() === "") {
            allFilled = false;
          }
        });

        // Check if all required checkboxes are checked
        checkboxes.forEach(function (checkbox) {
          if (!checkbox.checked) {
            allFilled = false;
          }
        });

        // Enable or disable the signup button based on all conditions
        signupButton.disabled = !(allFilled && passwordsMatch && validEmail && validEircode && validIban);
      }

      // Function to validate confirm password on blur
      function validateConfirmPassword() {
        let passwordsMatch = passwordField.value === confirmPasswordField.value;
        if (!passwordsMatch && confirmPasswordField.value.trim() !== "") {
          passwordMatchMessage.innerHTML = "Passwords do not match.";
          passwordMatchMessage.style.display = 'block';
          confirmPasswordField.classList.add('is-invalid');
        } else {
          passwordMatchMessage.innerHTML = "";
          passwordMatchMessage.style.display = 'none';
          confirmPasswordField.classList.remove('is-invalid');
        }
        checkFormCompletion();
      }

      // Function to validate email on blur
      function validateEmail() {
        const validEmail = emailPattern.test(emailField.value);
        if (!validEmail && emailField.value.trim() !== "") {
          emailError.style.display = 'block';
          emailField.classList.add('is-invalid');
        } else {
          emailError.style.display = 'none';
          emailField.classList.remove('is-invalid');
        }
        checkFormCompletion();
      }

      // Function to validate eircode on blur
      function validateEircode() {
        const validEircode = eircodePattern.test(eircodeField.value);
        if (!validEircode && eircodeField.value.trim() !== "") {
          eircodeError.style.display = 'block';
          eircodeField.classList.add('is-invalid');
        } else {
          eircodeError.style.display = 'none';
          eircodeField.classList.remove('is-invalid');
        }
        checkFormCompletion();
      }

      // Function to validate IBAN on blur
      function validateIban() {
        const validIban = ibanPattern.test(ibanField.value);
        if (!validIban && ibanField.value.trim() !== "") {
          ibanError.style.display = 'block';
          ibanField.classList.add('is-invalid');
        } else {
          ibanError.style.display = 'none';
          ibanField.classList.remove('is-invalid');
        }
        checkFormCompletion();
      }

      // Add event listeners to all fields to trigger form validation on any input
      allFields.forEach(function (field) {
        field.addEventListener('input', checkFormCompletion);
        field.addEventListener('change', checkFormCompletion);
      });

      // Add event listeners to checkboxes to trigger check on any change
      checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener('change', checkFormCompletion);
      });

      // Add event listeners to password field for real-time checking
      passwordField.addEventListener('input', checkFormCompletion);

      // Add event listeners to validate email, eircode, iban, and confirm password on blur
      confirmPasswordField.addEventListener('blur', validateConfirmPassword);
      emailField.addEventListener('blur', validateEmail);
      eircodeField.addEventListener('blur', validateEircode);
      ibanField.addEventListener('blur', validateIban);

      // Initial check on page load in case fields are already filled
      checkFormCompletion();
    });
  </script>
  <script>
    // Function to handle updating visibility and content
    function updatePaymentInfo(selectedValue, discount = false, referral = null) {
      const paymentInfoDiv = document.getElementById('influencer_info');
      const monthlyPaymentInfo = document.getElementById('monthly-payment-info');
      const paymentNoticeDiv = document.getElementById('payment_notice');
      const membershipInfo = document.getElementById('membership_info');

      // Reset all the divs to default hidden state
      paymentInfoDiv.style.display = 'none';
      monthlyPaymentInfo.style.display = 'none';

      // Determine the fee amounts based on discount or default values
      let yearlyFee = window.localStorage.getItem('yearly_fee');
      let monthlyFee = window.localStorage.getItem('monthly_fee');

      // Check the selected option and update the boxes accordingly
      if (selectedValue === 'Yearly') {
        // Annually selected
        paymentInfoDiv.style.display = 'none'; // No blue box for annually
        paymentNoticeDiv.innerText = referral && referral.yearlyMessage
          ? referral.yearlyMessage
          : `Your discounted annual fee of €${yearlyFee} will be collected around 7 days after signing up.`;
        membershipInfo.innerText = `Your OneBill membership will be €${yearlyFee} per year.`; // Update small tag text
        monthlyPaymentInfo.style.display = 'block'; // Show the purple box
      } else if (selectedValue === 'Monthly') {
        // Monthly selected
        paymentInfoDiv.innerHTML = '<strong>Click here to save even more by paying annually!</strong>'; // Always show this text for monthly option
        paymentInfoDiv.style.display = 'block'; // Show the blue box

        paymentNoticeDiv.innerText = `Your monthly fee of €${monthlyFee} will be collected around 7 days after signing up.`;
        membershipInfo.innerText = `Your OneBill membership will be €${monthlyFee} per month.`; // Update small tag text
        monthlyPaymentInfo.style.display = 'block'; // Show the purple box
      }
    }

    // Function to check for specific reference in the URL and match it to a discount
    function getReferralDetails() {
      const urlParams = new URLSearchParams(window.location.search);
      const referralCode = urlParams.get('reference'); // Check if ?reference= exists
      if (referralCode && referralCodes[referralCode]) {
        return referralCodes[referralCode]; // Return the referral object if found
      }
      return null; // No referral if the code is not found
    }

    // Listen for manual changes on the payment_period dropdown
    document.getElementById('payment_period').addEventListener('change', function () {
      const selectedValue = this.value;
      const referral = getReferralDetails();
      updatePaymentInfo(selectedValue, referral, referral); // Pass referral details
    });

    // Handle the click event on the blue box to switch to "Annually"
    document.getElementById('influencer_info').addEventListener('click', function () {
      const paymentPeriodDropdown = document.getElementById('payment_period');
      const referral = getReferralDetails();

      // Change the value of the dropdown to "Yearly"
      paymentPeriodDropdown.value = 'Yearly';

      // Trigger the change event manually to update the page
      updatePaymentInfo('Yearly', referral, referral); // Manually call the update function
    });

    // Handle changes in radio buttons
    document.getElementById('monthly').addEventListener('change', function () {
      if (this.checked) {
        const referral = getReferralDetails();
        document.getElementById('payment_period').value = 'Monthly';
        updatePaymentInfo('Monthly', referral, referral);
      }
    });

    document.getElementById('yearly').addEventListener('change', function () {
      if (this.checked) {
        const referral = getReferralDetails();
        document.getElementById('payment_period').value = 'Yearly';
        updatePaymentInfo('Yearly', referral, referral);
      }
    });

    // Optionally, you can call this function to set the initial state if something is already selected
    window.onload = function () {
      const initialSelection = document.getElementById('payment_period').value;
      const referral = getReferralDetails();
      if (initialSelection) {
        updatePaymentInfo(initialSelection, referral, referral);
      }
    }
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Retrieve the saved phone number and email from localStorage
      const savedPhoneNumber = localStorage.getItem("savedPhoneNumber");
      const savedEmailAddress = localStorage.getItem("savedEmailAddress");

      // If values are found, populate the corresponding fields
      if (savedPhoneNumber) {
        const localPhoneInput = document.getElementById("localphone");
        const phoneInput = document.getElementById("phone");

        // Populate the fields
        localPhoneInput.value = savedPhoneNumber;
        phoneInput.value = savedPhoneNumber;

        // Trigger an input event to simulate manual entry
        localPhoneInput.dispatchEvent(new Event('input'));
      }

      if (savedEmailAddress) {
        const emailInput = document.getElementById("email");
        emailInput.value = savedEmailAddress;

        // Trigger an input event to simulate manual entry
        emailInput.dispatchEvent(new Event('input'));
      }
    });
  </script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const eircodeInput = document.getElementById("eircode");
      const addressInput = document.getElementById("address");
      const addressField = document.getElementById("address-field");
      const eircodeError = document.getElementById("eircodeError");
      const dropdownMenu = document.getElementById("dropdown-menu");

      // Function to fetch addresses based on Eircode input
      function showDropdown() {
        const eircode = eircodeInput.value.trim();

        if (eircode.length >= 2) {
          $.ajax({
            type: "POST",
            url: "https://admin.onebill.ie/api/getAddress",
            data: { eircode: eircode },
            success: function (data) {
              dropdownMenu.innerHTML = "";

              if (data.addresses && data.addresses.length > 0) {
                dropdownMenu.style.display = "block";
                data.addresses.forEach(addrObj => {
                  if (addrObj.address) {
                    const newItem = document.createElement("div");
                    newItem.classList.add("dropdown-item");
                    newItem.textContent = addrObj.address;
                    newItem.setAttribute("data-eircode", addrObj.eircode);
                    newItem.style.padding = "8px";
                    newItem.style.cursor = "pointer";
                    newItem.addEventListener("click", function () {
                      selectEircode(newItem);
                    });
                    dropdownMenu.appendChild(newItem);
                  }
                });
              } else {
                dropdownMenu.style.display = "none";
              }
            },
            error: function () {
              dropdownMenu.style.display = "none";
            }
          });
        } else {
          dropdownMenu.style.display = "none";
        }
      }

      function selectEircode(element) {
        const selectedEircode = element.getAttribute("data-eircode");
        const selectedAddress = element.textContent;

        eircodeInput.value = selectedEircode;
        addressInput.value = selectedAddress;
        dropdownMenu.style.display = "none";
        addressField.style.display = "block";
      }

      eircodeInput.addEventListener("input", showDropdown);
      eircodeInput.addEventListener("focus", showDropdown);

      document.addEventListener("click", function (event) {
        if (!eircodeInput.contains(event.target) && !dropdownMenu.contains(event.target)) {
          dropdownMenu.style.display = "none";
        }
      });
    });
  </script>
</body>
</html>
